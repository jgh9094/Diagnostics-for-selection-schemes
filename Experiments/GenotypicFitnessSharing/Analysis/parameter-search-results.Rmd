# Genotypic fitness sharing

We present the results from our parameter sweeep on genotypic fitness sharing.
50 replicates are conducted for each sigma parameter value explored.
Note that when `sigma = 0.0`, no similarity penalty is used, and only stochastic remainder selection is used to identify parent solutions.

```{r, message=FALSE}
library(ggplot2)
library(cowplot)
library(dplyr)
library(PupillometryR)
```

## Exploitation rate results

Here we present the results for **best performances** found by each genotypic fitness sharing sigma value replicate on the exploitation rate diagnostic.
50 replicates are conducted for each sigma parameter value explored.
Note that when `sigma = 0.0`, no similarity penalty is used, and only stochastic remainder selection is used to identify parent solutions.

### Performance over time

Performance over time.

```{r gfs-exp-per-ot, warning=FALSE}
lines =  filter(gfs_ot, diagnostic == 'exploitation_rate') %>%
  group_by(Sigma, gen) %>%
  dplyr::summarise(
    min = min(pop_fit_max),
    mean = mean(pop_fit_max),
    max = max(pop_fit_max)
  )
ggplot(lines, aes(x=gen, y=mean / DIMENSIONALITY, group = Sigma, fill = Sigma, color = Sigma, shape = Sigma)) +
  geom_ribbon(aes(ymin = min / DIMENSIONALITY, ymax = max / DIMENSIONALITY), alpha = 0.1) +
  geom_line(size = 0.5) +
  geom_point(data = filter(lines, gen %% 2000 == 0 & gen != 0), size = 1.5, stroke = 2.0, alpha = 1.0) +
  scale_y_continuous(
    name="Average trait score"
  ) +
  scale_x_continuous(
    name="Generations",
    limits=c(0, 50000),
    breaks=c(0, 10000, 20000, 30000, 40000, 50000),
    labels=c("0e+4", "1e+4", "2e+4", "3e+4", "4e+4", "5e+4")

  ) +
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  ggtitle("Best performance over time") +
  p_theme
```


### Best performance throughout

The best performance found throughout 50,000 generations.

```{r gfs-exp-per-bst}
filter(gfs_best, col == 'pop_fit_max' & diagnostic == 'exploitation_rate') %>%
ggplot(., aes(x = Sigma, y = val / DIMENSIONALITY, color = Sigma, fill = Sigma, shape = Sigma)) +
  geom_flat_violin(position = position_nudge(x = .2, y = 0), scale = 'width', alpha = 0.2) +
  geom_point(position = position_jitter(width = .1), size = 1.5, alpha = 1.0) +
  geom_boxplot(color = 'black', width = .2, outlier.shape = NA, alpha = 0.0) +
  scale_y_continuous(
    name="Average trait score",
    limits=c(-1, 80),
    breaks=seq(0,80, 20),
    labels=c("0", "20", "40", "60", "80")
  ) +
  scale_x_discrete(
    name="Sigma"
  )+
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  ggtitle("Best performance throughout")+
  p_theme

```

#### Stats

Summary statistics for the best performance found throughout 50,000 generations.

```{r gfs-exp-per-sum}
performance = filter(gfs_best, col == 'pop_fit_max' & diagnostic == 'exploitation_rate')
group_by(performance, Sigma) %>%
  dplyr::summarise(
    count = n(),
    na_cnt = sum(is.na(val)),
    min = min(val / DIMENSIONALITY, na.rm = TRUE),
    median = median(val / DIMENSIONALITY, na.rm = TRUE),
    mean = mean(val / DIMENSIONALITY, na.rm = TRUE),
    max = max(val / DIMENSIONALITY, na.rm = TRUE),
    IQR = IQR(val / DIMENSIONALITY, na.rm = TRUE)
  )

```

Kruskal–Wallis test provides evidence of significant differences among sigma values on the best performance found throughout 50,000 generations

```{r gfs-exp-per-kru}
kruskal.test(val ~ Sigma,data = performance)
```

Results for post-hoc Wilcoxon rank-sum test with a Bonferroni correction on the best performance found throughout 50,000 generations.

```{r gfs-exp-per-wil}
pairwise.wilcox.test(x = performance$val, g = performance$Sigma , p.adjust.method = "bonferroni",
                     paired = FALSE, conf.int = FALSE, alternative = 'l')
```

### Multi-valley crossing

#### Performance over time

```{r gfs-exp-mvc-per}
# data for lines and shading on plots
lines = filter(gfs_ot_mvc, diagnostic == 'exploitation_rate') %>%
  group_by(Sigma, gen) %>%
  dplyr::summarise(
    min = min(pop_fit_max) / DIMENSIONALITY,
    mean = mean(pop_fit_max) / DIMENSIONALITY,
    max = max(pop_fit_max) / DIMENSIONALITY
  )

ggplot(lines, aes(x=gen, y=mean, group = Sigma, fill =Sigma, color = Sigma, shape = Sigma)) +
  geom_ribbon(aes(ymin = min, ymax = max), alpha = 0.1) +
  geom_line(size = 0.5) +
  geom_point(data = filter(lines, gen %% 2000 == 0 & gen != 0), size = 1.5, stroke = 2.0, alpha = 1.0) +
  scale_y_continuous(
    name="Average trait score",
    limits=c(0, 50),
    breaks=seq(0,50, 10),
    labels=c("0", "10", "20", "30", "40", "50")
  ) +
  scale_x_continuous(
    name="Generations",
    limits=c(0, 50000),
    breaks=c(0, 10000, 20000, 30000, 40000, 50000),
    labels=c("0e+4", "1e+4", "2e+4", "3e+4", "4e+4", "5e+4")

  ) +
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  ggtitle('Performance over time')+
  p_theme +
  guides(
    shape=guide_legend(nrow=2, title.position = "left"),
    color=guide_legend(nrow=2, title.position = "left"),
    fill=guide_legend(nrow=2, title.position = "left")
  )

```

#### Performance comparison

Best performances in the population at 40,000 and 50,000 generations.

```{r gfs-exp-mvc-lgd, echo = FALSE}
dummy_df = filter(filter(gfs_ot_mvc, diagnostic == 'exploitation_rate' & (gen == 50000 | gen == 40000) & Sigma != 'ran'))
dummy_df$Generation <- factor(dummy_df$gen)
p = ggplot(dummy_df, aes(x=gen, y=pop_fit_max / DIMENSIONALITY, group = Sigma, fill = Sigma, color = Generation, shape = Generation)) +
  geom_flat_violin(position = position_nudge(x = .2, y = 0), scale = 'width', alpha = 0.2) +
  geom_point(position = position_jitter(width = .03), size = 2, alpha = 1.0) +
  geom_boxplot(position = position_nudge(x = .13, y = 0), lwd = 1, width = .1, outlier.shape = NA, alpha = 0.0) +
  scale_shape_manual(values=c(0,1))+
  scale_colour_manual(values = mvc_col)+
  scale_fill_manual(values = cb_palette) + p_theme +
  guides(
    shape=guide_legend(ncol=2, title.position = "bottom"),
    color=guide_legend(ncol=2, title.position = "bottom"),
    fill='none')

legend <- cowplot::get_legend(
  p +
    guides(
      shape=guide_legend(ncol=2, title.position = "left"),
      color=guide_legend(ncol=2, title.position = "left"),
      fill='none'
    ) +
    theme(
      legend.position = "top",
      legend.box="verticle",
      legend.justification="center"
    )
)
rm(dummy_df, p)
```

```{r gfs-exp-mvc-per-sli, warning=FALSE}
# 80% and final generation comparison
end = filter(gfs_ot_mvc, diagnostic == 'exploitation_rate' & gen == 50000 & Sigma != 'ran')
end$Generation <- factor(end$gen)

mid = filter(gfs_ot_mvc, diagnostic == 'exploitation_rate' & gen == 40000 & Sigma != 'ran')
mid$Generation <- factor(mid$gen)

mvc_p = ggplot(mid, aes(x = Sigma, y=pop_fit_max / DIMENSIONALITY, group = Sigma, shape = Generation)) +
  geom_point(col = mvc_col[1] , position = position_jitternudge(jitter.width = .03, nudge.x = -0.05), size = 2, alpha = 1.0) +
  geom_boxplot(position = position_nudge(x = -.15, y = 0), lwd = 0.7, col = mvc_col[1], fill = mvc_col[1], width = .1, outlier.shape = NA, alpha = 0.0) +

  geom_point(data = end, aes(x = Sigma, y=pop_fit_max / DIMENSIONALITY), col = mvc_col[2], position = position_jitternudge(jitter.width = .03, nudge.x = 0.05), size = 2, alpha = 1.0) +
  geom_boxplot(data = end, aes(x = Sigma, y=pop_fit_max / DIMENSIONALITY), position = position_nudge(x = .15, y = 0), lwd = 0.7, col = mvc_col[2], fill = mvc_col[2], width = .1, outlier.shape = NA, alpha = 0.0) +

  scale_y_continuous(
    name="Average trait score",
    limits=c(0, 50),
    breaks=seq(0,50, 10),
    labels=c("0", "10", "20", "30", "40", "50")
  ) +
  scale_x_discrete(
    name="Sigma"
  )+
  scale_shape_manual(values=c(0,1))+
  scale_colour_manual(values = c(mvc_col[1],mvc_col[2])) +
  p_theme

plot_grid(
  mvc_p +
    ggtitle("Performance comparisons") +
    theme(legend.position="none"),
  legend,
  nrow=2,
  rel_heights = c(1,.05),
  label_size = TSIZE
)
```

#### Stats

Summary statistics for the performance of the best performance at 40,000 and 50,000 generations.

```{r gfs-exp-mvc-per-sli-sum}
slices = filter(gfs_ot_mvc, diagnostic == 'exploitation_rate' & (gen == 50000 | gen == 40000))
slices$Generation <- factor(slices$gen, levels = c(50000,40000))
slices %>%
  group_by(Sigma, Generation) %>%
  dplyr::summarise(
    count = n(),
    na_cnt = sum(is.na(pop_fit_max  / DIMENSIONALITY)),
    min = min(pop_fit_max  / DIMENSIONALITY, na.rm = TRUE),
    median = median(pop_fit_max  / DIMENSIONALITY, na.rm = TRUE),
    mean = mean(pop_fit_max  / DIMENSIONALITY, na.rm = TRUE),
    max = max(pop_fit_max  / DIMENSIONALITY, na.rm = TRUE),
    IQR = IQR(pop_fit_max  / DIMENSIONALITY, na.rm = TRUE)
  )
```

Sigma 0.0
```{r gfs-exp-mvc-per-0}
wilcox.test(x = filter(slices, Sigma == 0.0 & Generation == 50000)$pop_fit_max,
            y = filter(slices, Sigma == 0.0 & Generation == 40000)$pop_fit_max,
            alternative = 't')
```

Sigma 0.1
```{r gfs-exp-mvc-per-01}
wilcox.test(x = filter(slices, Sigma == 0.1 & Generation == 50000)$pop_fit_max,
            y = filter(slices, Sigma == 0.1 & Generation == 40000)$pop_fit_max,
            alternative = 't')
```

Sigma 0.3
```{r gfs-exp-mvc-per-03}
wilcox.test(x = filter(slices, Sigma == 0.3 & Generation == 50000)$pop_fit_max,
            y = filter(slices, Sigma == 0.3 & Generation == 40000)$pop_fit_max,
            alternative = 't')
```

Sigma 0.6
```{r gfs-exp-mvc-per-06}
wilcox.test(x = filter(slices, Sigma == 0.6 & Generation == 50000)$pop_fit_max,
            y = filter(slices, Sigma == 0.6 & Generation == 40000)$pop_fit_max,
            alternative = 't')
```

Sigma 1.2
```{r gfs-exp-mvc-per-12}
wilcox.test(x = filter(slices, Sigma == 1.2 & Generation == 50000)$pop_fit_max,
            y = filter(slices, Sigma == 1.2 & Generation == 40000)$pop_fit_max,
            alternative = 't')
```

Sigma 2.5
```{r  gfs-exp-mvc-per-25}
wilcox.test(x = filter(slices, Sigma == 2.5 & Generation == 50000)$pop_fit_max,
            y = filter(slices, Sigma == 2.5 & Generation == 40000)$pop_fit_max,
            alternative = 't')
```

Sigma 5.0
```{r  gfs-exp-mvc-per-25}
wilcox.test(x = filter(slices, Sigma == 5.0 & Generation == 50000)$pop_fit_max,
            y = filter(slices, Sigma == 5.0 & Generation == 40000)$pop_fit_max,
            alternative = 't')
```

## Ordered exploitation results

Here we present the results for **best performances** found by each genotypic fitness sharing sigma value replicate on the ordered exploitation diagnostic.
Best performance found refers to the largest average trait score found in a given population.
Note that performance values fall between 0 and 100.

### Performance over time

Performance over time.

```{r gfs-ord-per-ot, warning=FALSE}
lines =  filter(gfs_ot, diagnostic == 'ordered_exploitation') %>%
  group_by(Sigma, gen) %>%
  dplyr::summarise(
    min = min(pop_fit_max),
    mean = mean(pop_fit_max),
    max = max(pop_fit_max)
  )
ggplot(lines, aes(x=gen, y=mean / DIMENSIONALITY, group = Sigma, fill = Sigma, color = Sigma, shape = Sigma)) +
  geom_ribbon(aes(ymin = min / DIMENSIONALITY, ymax = max / DIMENSIONALITY), alpha = 0.1) +
  geom_line(size = 0.5) +
  geom_point(data = filter(lines, gen %% 2000 == 0 & gen != 0), size = 1.5, stroke = 2.0, alpha = 1.0) +
  scale_y_continuous(
    name="Average trait score"
  ) +
  scale_x_continuous(
    name="Generations",
    limits=c(0, 50000),
    breaks=c(0, 10000, 20000, 30000, 40000, 50000),
    labels=c("0e+4", "1e+4", "2e+4", "3e+4", "4e+4", "5e+4")

  ) +
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  ggtitle("Best performance over time") +
  p_theme
```

### Best performance throughout

The best performance found throughout 50,000 generations.

```{r gfs-ord-per-bst}
filter(gfs_best, col == 'pop_fit_max' & diagnostic == 'ordered_exploitation') %>%
  ggplot(., aes(x = Sigma, y = val / DIMENSIONALITY, color = Sigma, fill = Sigma, shape = Sigma)) +
  geom_flat_violin(position = position_nudge(x = .2, y = 0), scale = 'width', alpha = 0.2) +
  geom_point(position = position_jitter(width = .1), size = 1.5, alpha = 1.0) +
  geom_boxplot(color = 'black', width = .2, outlier.shape = NA, alpha = 0.0) +
  scale_y_continuous(
    name="Average trait score"
  ) +
  scale_x_discrete(
    name="Sigma"
  )+
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  ggtitle("Best performance throughout")+
  p_theme
```

#### Stats

Summary statistics about the best performance found.

```{r gfs-ord-per-sum}
performance = filter(gfs_best, col == 'pop_fit_max' & diagnostic == 'ordered_exploitation')
group_by(performance, Sigma) %>%
  dplyr::summarise(
    count = n(),
    na_cnt = sum(is.na(val)),
    min = min(val / DIMENSIONALITY, na.rm = TRUE),
    median = median(val / DIMENSIONALITY, na.rm = TRUE),
    mean = mean(val / DIMENSIONALITY, na.rm = TRUE),
    max = max(val / DIMENSIONALITY, na.rm = TRUE),
    IQR = IQR(val / DIMENSIONALITY, na.rm = TRUE)
  )

```

Kruskal–Wallis test provides evidence of statistical differences for the best performance found in the pouplation throughout 50,000 generations.

```{r gfs-ord-per-kru}
kruskal.test(val ~ Sigma,data = performance)
```

Results for post-hoc Wilcoxon rank-sum test with a Bonferroni correction on the best performance found in the pouplation throughout 50,000 generations.

```{r gfs-ord-per-wil}
pairwise.wilcox.test(x = performance$val, g = best$Sigma , p.adjust.method = "bonferroni",
                     paired = FALSE, conf.int = FALSE, alternative = 'l')
```

### Multi-valley crossing

#### Performance comparison

Best performances in the population at 40,000 and 50,000 generations.

```{r gfs-exp-mvc-per-sli, warning=FALSE}
# 80% and final generation comparison
end = filter(gfs_ot_mvc, diagnostic == 'ordered_exploitation' & gen == 50000)
end$Generation <- factor(end$gen)

mid = filter(gfs_ot_mvc, diagnostic == 'ordered_exploitation' & gen == 40000)
mid$Generation <- factor(mid$gen)

mvc_p = ggplot(mid, aes(x = Sigma, y=pop_fit_max / DIMENSIONALITY, group = Sigma, shape = Generation)) +
  geom_point(col = mvc_col[1] , position = position_jitternudge(jitter.width = .03, nudge.x = -0.05), size = 2, alpha = 1.0) +
  geom_boxplot(position = position_nudge(x = -.15, y = 0), lwd = 0.7, col = mvc_col[1], fill = mvc_col[1], width = .1, outlier.shape = NA, alpha = 0.0) +

  geom_point(data = end, aes(x = Sigma, y=pop_fit_max / DIMENSIONALITY), col = mvc_col[2], position = position_jitternudge(jitter.width = .03, nudge.x = 0.05), size = 2, alpha = 1.0) +
  geom_boxplot(data = end, aes(x = Sigma, y=pop_fit_max / DIMENSIONALITY), position = position_nudge(x = .15, y = 0), lwd = 0.7, col = mvc_col[2], fill = mvc_col[2], width = .1, outlier.shape = NA, alpha = 0.0) +

  scale_y_continuous(
    name="Average trait score"
  ) +
  scale_x_discrete(
    name="Sigma"
  )+
  scale_shape_manual(values=c(0,1))+
  scale_colour_manual(values = c(mvc_col[1],mvc_col[2])) +
  p_theme

plot_grid(
  mvc_p +
    ggtitle("Performance comparisons") +
    theme(legend.position="none"),
  legend,
  nrow=2,
  rel_heights = c(1,.05),
  label_size = TSIZE
)
```

##### Stats

Summary statistics for the performance of the best performance at 40,000 and 50,000 generations.

```{r gfs-exp-mvc-per-sli-sum}
slices = filter(gfs_ot_mvc, diagnostic == 'ordered_exploitation' & (gen == 50000 | gen == 40000))
slices$Generation <- factor(slices$gen, levels = c(50000,40000))
slices %>%
  group_by(Sigma, Generation) %>%
  dplyr::summarise(
    count = n(),
    na_cnt = sum(is.na(pop_fit_max  / DIMENSIONALITY)),
    min = min(pop_fit_max  / DIMENSIONALITY, na.rm = TRUE),
    median = median(pop_fit_max  / DIMENSIONALITY, na.rm = TRUE),
    mean = mean(pop_fit_max  / DIMENSIONALITY, na.rm = TRUE),
    max = max(pop_fit_max  / DIMENSIONALITY, na.rm = TRUE),
    IQR = IQR(pop_fit_max  / DIMENSIONALITY, na.rm = TRUE)
  )
```

Sigma 0.0
```{r gfs-ord-mvc-per-0}
wilcox.test(x = filter(slices, Sigma == 0.0 & Generation == 50000)$pop_fit_max,
            y = filter(slices, Sigma == 0.0 & Generation == 40000)$pop_fit_max,
            alternative = 't')
```

Sigma 0.1
```{r gfs-ord-mvc-per-01}
wilcox.test(x = filter(slices, Sigma == 0.1 & Generation == 50000)$pop_fit_max,
            y = filter(slices, Sigma == 0.1 & Generation == 40000)$pop_fit_max,
            alternative = 't')
```

Sigma 0.3
```{r gfs-ord-mvc-per-03}
wilcox.test(x = filter(slices, Sigma == 0.3 & Generation == 50000)$pop_fit_max,
            y = filter(slices, Sigma == 0.3 & Generation == 40000)$pop_fit_max,
            alternative = 't')
```

Sigma 0.6
```{r gfs-ord-mvc-per-06}
wilcox.test(x = filter(slices, Sigma == 0.6 & Generation == 50000)$pop_fit_max,
            y = filter(slices, Sigma == 0.6 & Generation == 40000)$pop_fit_max,
            alternative = 't')
```

Sigma 1.2
```{r gfs-ord-mvc-per-12}
wilcox.test(x = filter(slices, Sigma == 1.2 & Generation == 50000)$pop_fit_max,
            y = filter(slices, Sigma == 1.2 & Generation == 40000)$pop_fit_max,
            alternative = 't')
```

Sigma 2.5
```{r  gfs-ord-mvc-per-25}
wilcox.test(x = filter(slices, Sigma == 2.5 & Generation == 50000)$pop_fit_max,
            y = filter(slices, Sigma == 2.5 & Generation == 40000)$pop_fit_max,
            alternative = 't')
```

Sigma 5.0
```{r  gfs-ord-mvc-per-25}
wilcox.test(x = filter(slices, Sigma == 5.0 & Generation == 50000)$pop_fit_max,
            y = filter(slices, Sigma == 5.0 & Generation == 40000)$pop_fit_max,
            alternative = 't')
```


## Contraditory objectives diagnostic

Here we present the results for **satisfactory trait coverage** and **activation gene coverage** found by each genotypic fitness sharing sigma value replicate on the ordered exploitation diagnostic.
Satisfactory trait coverage refers to the count of unique satisfied DIMENSIONALITY in the population, while activation gene coverage refers to the count of unique activation genes in the population.
Note that both coverage values fall between 0 and 100.

### Satisfactory trait coverage

Satisfactory trait coverage analysis.

#### Coverage over time

Satisfactory trait coverage over time.

```{r gfs-con-sat-ot, warning=FALSE}
lines = filter(gfs_ot, diagnostic == 'contradictory_objectives') %>%
  group_by(Sigma, gen) %>%
  dplyr::summarise(
    min = min(pop_uni_obj),
    mean = mean(pop_uni_obj),
    max = max(pop_uni_obj)
  )
ggplot(lines, aes(x=gen, y=mean, group = Sigma, fill =Sigma, color = Sigma, shape = Sigma)) +
  geom_ribbon(aes(ymin = min, ymax = max), alpha = 0.1) +
  geom_line(size = 0.5) +
  geom_point(data = filter(lines, gen %% 2000 == 0 & gen != 0), size = 1.5, stroke = 2.0, alpha = 1.0) +
  scale_y_continuous(
    name="Coverage",
    limits=c(0, 5)
  ) +
  scale_x_continuous(
    name="Generations",
    limits=c(0, 50000),
    breaks=c(0, 10000, 20000, 30000, 40000, 50000),
    labels=c("0e+4", "1e+4", "2e+4", "3e+4", "4e+4", "5e+4")

  ) +
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  ggtitle("Satisfactory trait coverage over time") +
  p_theme
```


#### Best coverage throughout

Best satisfactory trait coverage throughout 50,000 generations.

```{r gfs-con-sat-bst}
filter(gfs_best, col == 'pop_uni_obj' & diagnostic == 'contradictory_objectives') %>%
  ggplot(., aes(x = Sigma, y = val, color = Sigma, fill = Sigma, shape = Sigma)) +
  geom_flat_violin(position = position_nudge(x = .2, y = 0), scale = 'width', alpha = 0.2) +
  geom_point(position = position_jitter(width = .1), size = 1.5, alpha = 1.0) +
  geom_boxplot(color = 'black', width = .2, outlier.shape = NA, alpha = 0.0) +
    scale_y_continuous(
      name="Coverage"
    ) +
      scale_x_discrete(
        name="Sigma"
      )+
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  ggtitle("Best satisfactory trait coverage throughout")+
  p_theme

```

##### Stats

Summary statistics for the best satisfactory trait coverage throughout 50,000 generations.

```{r gfs-con-sat-sum}
coverage = filter(gfs_best, col == 'pop_uni_obj' & diagnostic == 'contradictory_objectives')
  group_by(coverage, Sigma) %>%
  dplyr::summarise(
    count = n(),
    na_cnt = sum(is.na(val)),
    min = min(val, na.rm = TRUE),
    median = median(val, na.rm = TRUE),
    mean = mean(val, na.rm = TRUE),
    max = max(val, na.rm = TRUE),
    IQR = IQR(val, na.rm = TRUE)
  )
```

Kruskal–Wallis test provides evidence of no statistical difference among satisfactory trait coverage throughout 50,000 generations.

```{r gfs-con-sat-kru}
kruskal.test(val ~ Sigma, data = coverage)
```

#### End of 50,000 generations

Satisfactory trait coverage in the final population (50,000 generations).

```{r gfs-con-sat-end}
end = filter(gfs_end, diagnostic == 'contradictory_objectives')
plot = ggplot(end, aes(x = Sigma, y = pop_uni_obj, color = Sigma, fill = Sigma, shape = Sigma)) +
  geom_flat_violin(position = position_nudge(x = .2, y = 0), scale = 'width', alpha = 0.2) +
  geom_point(position = position_jitter(width = .1), size = 1.5, alpha = 1.0) +
  geom_boxplot(color = 'black', width = .2, outlier.shape = NA, alpha = 0.0) +
  scale_y_continuous(
    name="Coverage",
    limits=c(0, 5)
  ) +
  scale_x_discrete(
    name="Sigma"
  )+
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  p_theme

plot_grid(
  plot +
    ggtitle("Final satisfactory trait coverage") +
    theme(legend.position="none"),
  legend,
  nrow=2,
  rel_heights = c(2,.3),
  label_size = TSIZE
)
```

##### Stats

Summary statistics for satisfactory trait coverage in the final population (50,000 generations).

```{r gfs-con-sat-end-sum}
group_by(end, Sigma) %>%
  dplyr::summarise(
    count = n(),
    na_cnt = sum(is.na(pop_uni_obj)),
    min = min(pop_uni_obj, na.rm = TRUE),
    median = median(pop_uni_obj, na.rm = TRUE),
    mean = mean(pop_uni_obj, na.rm = TRUE),
    max = max(pop_uni_obj, na.rm = TRUE),
    IQR = IQR(pop_uni_obj, na.rm = TRUE)
  )
```

Kruskal–Wallis test provides evidence of no statistical difference among satisfactory trait coverage throughout 50,000 generations.

```{r gfs-con-sat-end-kru}
kruskal.test(pop_uni_obj ~ Sigma, data = end)
```

### Activation gene coverage

Here we analyze the activation gene coverage for each parameter replicate on the contradictory objectives diagnostic.

#### Coverage over time

Activation gene coverage over time.

```{r gfs-con-act-ot, warning=FALSE}
lines = filter(gfs_ot, diagnostic == 'contradictory_objectives') %>%
  group_by(Sigma, gen) %>%
  dplyr::summarise(
    min = min(uni_str_pos),
    mean = mean(uni_str_pos),
    max = max(uni_str_pos)
  )
ggplot(lines, aes(x=gen, y=mean, group = Sigma, fill =Sigma, color = Sigma, shape = Sigma)) +
  geom_ribbon(aes(ymin = min, ymax = max), alpha = 0.1) +
  geom_line(size = 0.5) +
  geom_point(data = filter(lines, gen %% 2000 == 0 & gen != 0), size = 1.5, stroke = 2.0, alpha = 1.0) +
  scale_y_continuous(
    name="Coverage",
    limits=c(-1, 101),
    breaks=seq(0,100, 20),
    labels=c("0", "20", "40", "60", "80", "100")
  ) +
  scale_x_continuous(
    name="Generations",
    limits=c(0, 50000),
    breaks=c(0, 10000, 20000, 30000, 40000, 50000),
    labels=c("0e+4", "1e+4", "2e+4", "3e+4", "4e+4", "5e+4")

  ) +
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  ggtitle("Activation gene coverage over time") +
  p_theme
```

#### End of 50,000 generations

Activation gene coverage in the final population (50,000 generations).

```{r gfs-con-act-end}
filter(gfs_ot, diagnostic == 'contradictory_objectives' & gen == 50000) %>%
  ggplot(., aes(x = Sigma, y = uni_str_pos, color = Sigma, fill = Sigma, shape = Sigma)) +
    geom_flat_violin(position = position_nudge(x = .2, y = 0), scale = 'width', alpha = 0.2) +
    geom_point(position = position_jitter(width = .1), size = 1.5, alpha = 1.0) +
    geom_boxplot(color = 'black', width = .2, outlier.shape = NA, alpha = 0.0) +
    scale_y_continuous(
      name="Coverage",
      limits=c(0, 5)
    ) +
    scale_x_discrete(
      name="Sigma"
    )+
    scale_shape_manual(values=SHAPE)+
    scale_colour_manual(values = cb_palette) +
    scale_fill_manual(values = cb_palette) +
    ggtitle("Final activation gene coverage") +
    p_theme

```

##### Stats

Summary statistics for activation gene coverage in the final population (50,000 generations).

```{r gfs-con-act-end-sum}
coverage = filter(gfs_ot, diagnostic == 'contradictory_objectives' & gen == 50000)
group_by(coverage, Sigma) %>%
  dplyr::summarise(
    count = n(),
    na_cnt = sum(is.na(uni_str_pos)),
    min = min(uni_str_pos, na.rm = TRUE),
    median = median(uni_str_pos, na.rm = TRUE),
    mean = mean(uni_str_pos, na.rm = TRUE),
    max = max(uni_str_pos, na.rm = TRUE),
    IQR = IQR(uni_str_pos, na.rm = TRUE)
  )
```

Kruskal–Wallis test provides evidence of no statistical difference for activation gene coverage in the final population (50,000 generations).

```{r gfs-con-act-end-kru}
kruskal.test(uni_str_pos ~ Sigma,data = coverage)
```

### Multi-valley crossing

#### Satisfactory trait coverage over time

```{r gfs-con-mvc-sat-ot}
lines = filter(gfs_ot_mvc, diagnostic == 'contradictory_objectives') %>%
  group_by(Sigma, gen) %>%
  dplyr::summarise(
    min = min(pop_uni_obj),
    mean = mean(pop_uni_obj),
    max = max(pop_uni_obj)
  )
ggplot(lines, aes(x=gen, y=mean, group = Sigma, fill =Sigma, color = Sigma, shape = Sigma)) +
  geom_ribbon(aes(ymin = min, ymax = max), alpha = 0.1) +
  geom_line(size = 0.5) +
  geom_point(data = filter(lines, gen %% 2000 == 0 & gen != 0), size = 1.5, stroke = 2.0, alpha = 1.0) +
  scale_y_continuous(
    name="Coverage",
    limits=c(0, 5)
  ) +
  scale_x_continuous(
    name="Generations",
    limits=c(0, 50000),
    breaks=c(0, 10000, 20000, 30000, 40000, 50000),
    labels=c("0e+4", "1e+4", "2e+4", "3e+4", "4e+4", "5e+4")

  ) +
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  ggtitle("Satisfactory trait coverage over time") +
  p_theme
```

#### Satisfactory trait coverage comparison

Best performances in the population at 40,000 and 50,000 generations.

```{r gfs-con-mvc-per-sli, warning=FALSE}
# 80% and final generation comparison
end = filter(gfs_ot_mvc, diagnostic == 'contradictory_objectives' & gen == 50000)
end$Generation <- factor(end$gen)

mid = filter(gfs_ot_mvc, diagnostic == 'contradictory_objectives' & gen == 40000)
mid$Generation <- factor(mid$gen)

mvc_p = ggplot(mid, aes(x = Sigma, y=pop_uni_obj, group = Sigma, shape = Generation)) +
  geom_point(col = mvc_col[1] , position = position_jitternudge(jitter.width = .03, nudge.x = -0.05), size = 2, alpha = 1.0) +
  geom_boxplot(position = position_nudge(x = -.15, y = 0), lwd = 0.7, col = mvc_col[1], fill = mvc_col[1], width = .1, outlier.shape = NA, alpha = 0.0) +

  geom_point(data = end, aes(x = Sigma, y=pop_uni_obj), col = mvc_col[2], position = position_jitternudge(jitter.width = .03, nudge.x = 0.05), size = 2, alpha = 1.0) +
  geom_boxplot(data = end, aes(x = Sigma, y=pop_uni_obj), position = position_nudge(x = .15, y = 0), lwd = 0.7, col = mvc_col[2], fill = mvc_col[2], width = .1, outlier.shape = NA, alpha = 0.0) +

  scale_y_continuous(
    name="Coverage",
  ) +
  scale_x_discrete(
    name="Sigma"
  )+
  scale_shape_manual(values=c(0,1))+
  scale_colour_manual(values = c(mvc_col[1],mvc_col[2])) +
  p_theme

plot_grid(
  mvc_p +
    ggtitle("Satisfactory trait coverage over time") +
    theme(legend.position="none"),
  legend,
  nrow=2,
  rel_heights = c(1,.05),
  label_size = TSIZE
)
```

##### Stats

Summary statistics for the performance of the best performance at 40,000 and 50,000 generations.

```{r gfs-con-mvc-per-sli-sum}
slices = filter(gfs_ot_mvc, diagnostic == 'contradictory_objectives' & (gen == 50000 | gen == 40000))
slices$Generation <- factor(slices$gen, levels = c(50000,40000))
slices %>%
  group_by(Sigma, Generation) %>%
  dplyr::summarise(
    count = n(),
    na_cnt = sum(is.na(pop_uni_obj)),
    min = min(pop_uni_obj, na.rm = TRUE),
    median = median(pop_uni_obj, na.rm = TRUE),
    mean = mean(pop_uni_obj, na.rm = TRUE),
    max = max(pop_uni_obj, na.rm = TRUE),
    IQR = IQR(pop_uni_obj, na.rm = TRUE)
  )
```

Sigma 0.0
```{r gfs-con-mvc-per-0}
wilcox.test(x = filter(slices, Sigma == 0.0 & Generation == 50000)$pop_uni_obj,
            y = filter(slices, Sigma == 0.0 & Generation == 40000)$pop_uni_obj,
            alternative = 't')
```

Sigma 0.1
```{r gfs-con-mvc-per-01}
wilcox.test(x = filter(slices, Sigma == 0.1 & Generation == 50000)$pop_uni_obj,
            y = filter(slices, Sigma == 0.1 & Generation == 40000)$pop_uni_obj,
            alternative = 't')
```

Sigma 0.3
```{r gfs-con-mvc-per-03}
wilcox.test(x = filter(slices, Sigma == 0.3 & Generation == 50000)$pop_uni_obj,
            y = filter(slices, Sigma == 0.3 & Generation == 40000)$pop_uni_obj,
            alternative = 't')
```

Sigma 0.6
```{r gfs-con-mvc-per-06}
wilcox.test(x = filter(slices, Sigma == 0.6 & Generation == 50000)$pop_uni_obj,
            y = filter(slices, Sigma == 0.6 & Generation == 40000)$pop_uni_obj,
            alternative = 't')
```

Sigma 1.2
```{r gfs-con-mvc-per-12}
wilcox.test(x = filter(slices, Sigma == 1.2 & Generation == 50000)$pop_uni_obj,
            y = filter(slices, Sigma == 1.2 & Generation == 40000)$pop_uni_obj,
            alternative = 't')
```

Sigma 2.5
```{r  gfs-con-mvc-per-25}
wilcox.test(x = filter(slices, Sigma == 2.5 & Generation == 50000)$pop_uni_obj,
            y = filter(slices, Sigma == 2.5 & Generation == 40000)$pop_uni_obj,
            alternative = 't')
```

Sigma 5.0
```{r  gfs-con-mvc-per-25}
wilcox.test(x = filter(slices, Sigma == 5.0 & Generation == 50000)$pop_uni_obj,
            y = filter(slices, Sigma == 5.0 & Generation == 40000)$pop_uni_obj,
            alternative = 't')
```


#### Activation gene coverage over time

```{r gfs-con-mvc-sat-ot}
lines = filter(gfs_ot_mvc, diagnostic == 'contradictory_objectives') %>%
  group_by(Sigma, gen) %>%
  dplyr::summarise(
    min = min(uni_str_pos),
    mean = mean(uni_str_pos),
    max = max(uni_str_pos)
  )
ggplot(lines, aes(x=gen, y=mean, group = Sigma, fill =Sigma, color = Sigma, shape = Sigma)) +
  geom_ribbon(aes(ymin = min, ymax = max), alpha = 0.1) +
  geom_line(size = 0.5) +
  geom_point(data = filter(lines, gen %% 2000 == 0 & gen != 0), size = 1.5, stroke = 2.0, alpha = 1.0) +
  scale_y_continuous(
    name="Coverage"
  ) +
  scale_x_continuous(
    name="Generations",
    limits=c(0, 50000),
    breaks=c(0, 10000, 20000, 30000, 40000, 50000),
    labels=c("0e+4", "1e+4", "2e+4", "3e+4", "4e+4", "5e+4")

  ) +
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  ggtitle("Activation gene coverage over time") +
  p_theme
```

#### Activation gene coverage comparison

Best performances in the population at 40,000 and 50,000 generations.

```{r gfs-con-mvc-act-sli, warning=FALSE}
# 80% and final generation comparison
end = filter(gfs_ot_mvc, diagnostic == 'contradictory_objectives' & gen == 50000)
end$Generation <- factor(end$gen)

mid = filter(gfs_ot_mvc, diagnostic == 'contradictory_objectives' & gen == 40000)
mid$Generation <- factor(mid$gen)

mvc_p = ggplot(mid, aes(x = Sigma, y=uni_str_pos, group = Sigma, shape = Generation)) +
  geom_point(col = mvc_col[1] , position = position_jitternudge(jitter.width = .03, nudge.x = -0.05), size = 2, alpha = 1.0) +
  geom_boxplot(position = position_nudge(x = -.15, y = 0), lwd = 0.7, col = mvc_col[1], fill = mvc_col[1], width = .1, outlier.shape = NA, alpha = 0.0) +

  geom_point(data = end, aes(x = Sigma, y=uni_str_pos), col = mvc_col[2], position = position_jitternudge(jitter.width = .03, nudge.x = 0.05), size = 2, alpha = 1.0) +
  geom_boxplot(data = end, aes(x = Sigma, y=uni_str_pos), position = position_nudge(x = .15, y = 0), lwd = 0.7, col = mvc_col[2], fill = mvc_col[2], width = .1, outlier.shape = NA, alpha = 0.0) +

  scale_y_continuous(
    name="Coverage",
  ) +
  scale_x_discrete(
    name="Sigma"
  )+
  scale_shape_manual(values=c(0,1))+
  scale_colour_manual(values = c(mvc_col[1],mvc_col[2])) +
  p_theme

plot_grid(
  mvc_p +
    ggtitle("Satisfactory trait coverage over time") +
    theme(legend.position="none"),
  legend,
  nrow=2,
  rel_heights = c(1,.05),
  label_size = TSIZE
)
```

##### Stats

Summary statistics for the performance of the best performance at 40,000 and 50,000 generations.

```{r gfs-con-mvc-per-sli-sum}
slices = filter(gfs_ot_mvc, diagnostic == 'contradictory_objectives' & (gen == 50000 | gen == 40000))
slices$Generation <- factor(slices$gen, levels = c(50000,40000))
slices %>%
  group_by(Sigma, Generation) %>%
  dplyr::summarise(
    count = n(),
    na_cnt = sum(is.na(uni_str_pos)),
    min = min(uni_str_pos, na.rm = TRUE),
    median = median(uni_str_pos, na.rm = TRUE),
    mean = mean(uni_str_pos, na.rm = TRUE),
    max = max(uni_str_pos, na.rm = TRUE),
    IQR = IQR(uni_str_pos, na.rm = TRUE)
  )

```

Sigma 0.0
```{r gfs-con-mvc-per-0}
wilcox.test(x = filter(slices, Sigma == 0.0 & Generation == 50000)$uni_str_pos,
            y = filter(slices, Sigma == 0.0 & Generation == 40000)$uni_str_pos,
            alternative = 't')
```

Sigma 0.1
```{r gfs-con-mvc-per-01}
wilcox.test(x = filter(slices, Sigma == 0.1 & Generation == 50000)$uni_str_pos,
            y = filter(slices, Sigma == 0.1 & Generation == 40000)$uni_str_pos,
            alternative = 't')
```

Sigma 0.3
```{r gfs-con-mvc-per-03}
wilcox.test(x = filter(slices, Sigma == 0.3 & Generation == 50000)$uni_str_pos,
            y = filter(slices, Sigma == 0.3 & Generation == 40000)$uni_str_pos,
            alternative = 't')
```

Sigma 0.6
```{r gfs-con-mvc-per-06}
wilcox.test(x = filter(slices, Sigma == 0.6 & Generation == 50000)$uni_str_pos,
            y = filter(slices, Sigma == 0.6 & Generation == 40000)$uni_str_pos,
            alternative = 't')
```

Sigma 1.2
```{r gfs-con-mvc-per-12}
wilcox.test(x = filter(slices, Sigma == 1.2 & Generation == 50000)$uni_str_pos,
            y = filter(slices, Sigma == 1.2 & Generation == 40000)$uni_str_pos,
            alternative = 't')
```

Sigma 2.5
```{r  gfs-con-mvc-per-25}
wilcox.test(x = filter(slices, Sigma == 2.5 & Generation == 50000)$uni_str_pos,
            y = filter(slices, Sigma == 2.5 & Generation == 40000)$uni_str_pos,
            alternative = 't')
```

Sigma 5.0
```{r  gfs-con-mvc-per-25}
wilcox.test(x = filter(slices, Sigma == 5.0 & Generation == 50000)$uni_str_pos,
            y = filter(slices, Sigma == 5.0 & Generation == 40000)$uni_str_pos,
            alternative = 't')
```

## Multi-path exploration results

Here we present the results for **best performances** and **activation gene coverage** found by each genotypic fitness sharing sigma value replicate on the multi-path exploration diagnostic.
Best performance found refers to the largest average trait score found in a given population, while activation gene coverage refers to the count of unique activation genes in the population.
Note that both values fall between 0 and 100.

### Performance

Here we analyze the performances for each parameter replicate on the multi-path exploration diagnostic.

#### Performance over time

Performance over time.

```{r gfs-mpe-per-ot, warning=FALSE}
lines = filter(gfs_ot, diagnostic == 'multipath_exploration') %>%
  group_by(Sigma, gen) %>%
  dplyr::summarise(
    min = min(pop_fit_max),
    mean = mean(pop_fit_max),
    max = max(pop_fit_max)
  )
ggplot(lines, aes(x=gen, y=mean / DIMENSIONALITY, group = Sigma, fill = Sigma, color = Sigma, shape = Sigma)) +
  geom_ribbon(aes(ymin = min / DIMENSIONALITY, ymax = max / DIMENSIONALITY), alpha = 0.1) +
  geom_line(size = 0.5) +
  geom_point(data = filter(lines, gen %% 2000 == 0 & gen != 0), size = 1.5, stroke = 2.0, alpha = 1.0) +
  scale_y_continuous(
    name="Average trait score",
    limits=c(-1, 30)
  ) +
  scale_x_continuous(
    name="Generations",
    limits=c(0, 50000),
    breaks=c(0, 10000, 20000, 30000, 40000, 50000),
    labels=c("0e+4", "1e+4", "2e+4", "3e+4", "4e+4", "5e+4")

  ) +
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  ggtitle("Best performance over time") +
  p_theme
```

#### Best performance throughout

Here we plot the performance of the best performing solution found throughout 50,000 generations.

```{r gfs-mpe-per-bst}
filter(gfs_best, col == 'pop_fit_max' & diagnostic == 'multipath_exploration') %>%
  ggplot(., aes(x = Sigma, y = val / DIMENSIONALITY, color = Sigma, fill = Sigma, shape = Sigma)) +
  geom_flat_violin(position = position_nudge(x = .2, y = 0), scale = 'width', alpha = 0.2) +
  geom_point(position = position_jitter(width = .1), size = 1.5, alpha = 1.0) +
  geom_boxplot(color = 'black', width = .2, outlier.shape = NA, alpha = 0.0) +
  scale_y_continuous(
    name="Average trait score",
    limits=c(-1, 30)
  ) +
  scale_x_discrete(
    name="Sigma"
  )+
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  ggtitle("Best performance throughout") +
  p_theme
```

##### Stats

Summary statistics for the performance of the best performing solution.

```{r gfs-mpe-per-bst-sum}
performance = filter(gfs_best, col == 'pop_fit_max' & diagnostic == 'multipath_exploration')
group_by(performance, Sigma) %>%
dplyr::summarise(
  count = n(),
  na_cnt = sum(is.na(val)),
  min = min(val / DIMENSIONALITY, na.rm = TRUE),
  median = median(val / DIMENSIONALITY, na.rm = TRUE),
  mean = mean(val / DIMENSIONALITY, na.rm = TRUE),
  max = max(val / DIMENSIONALITY, na.rm = TRUE),
  IQR = IQR(val / DIMENSIONALITY, na.rm = TRUE)
)
```

Kruskal–Wallis test provides evidence of statistical differences among the best performing solution.

```{r gfs-mpe-per-bst-kru}
kruskal.test(val ~ Sigma,data = performance)
```

Results for post-hoc Wilcoxon rank-sum test with a Bonferroni correction on the best performing solution.

```{r gfs-mpe-per-bst-wil}
pairwise.wilcox.test(x = performance$val, g = performance$Sigma , p.adjust.method = "bonferroni",
                     paired = FALSE, conf.int = FALSE, alternative = 'l')
```

#### End of 50,000 generations

Best performance in the final population (50,000 generations).

```{r gfs-mpe-per-end}
filter(gfs_ot, diagnostic == 'multipath_exploration' & gen == 50000) %>%
ggplot(., aes(x = Sigma, y = pop_fit_max / DIMENSIONALITY, color = Sigma, fill = Sigma, shape = Sigma)) +
  geom_flat_violin(position = position_nudge(x = .2, y = 0), scale = 'width', alpha = 0.2) +
  geom_point(position = position_jitter(width = .1), size = 1.5, alpha = 1.0) +
  geom_boxplot(color = 'black', width = .2, outlier.shape = NA, alpha = 0.0) +
  scale_y_continuous(
    name="Average trait score",
    limits=c(-1, 30)
  ) +
  scale_x_discrete(
    name="Sigma"
  )+
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  ggtitle("Final best performance") +
  p_theme
```

##### Stats

Summary statistics for the best performance in the final population (50,000 generations).

```{r gfs-mpe-per-end-sum}
performance = filter(gfs_ot, diagnostic == 'multipath_exploration' & gen == 50000)
group_by(performance, Sigma) %>%
dplyr::summarise(
  count = n(),
  na_cnt = sum(is.na(pop_fit_max / DIMENSIONALITY)),
  min = min(pop_fit_max / DIMENSIONALITY, na.rm = TRUE),
  median = median(pop_fit_max / DIMENSIONALITY, na.rm = TRUE),
  mean = mean(pop_fit_max / DIMENSIONALITY, na.rm = TRUE),
  max = max(pop_fit_max / DIMENSIONALITY, na.rm = TRUE),
  IQR = IQR(pop_fit_max / DIMENSIONALITY, na.rm = TRUE)
)
```

Kruskal–Wallis test provides evidence of statistical differences among best performance in the final population (50,000 generations).

```{r gfs-mpe-per-end-kru}
kruskal.test(pop_fit_max ~ Sigma, data = performance)
```

Results for post-hoc Wilcoxon rank-sum test with a Bonferroni correction on the best performance in the final population (50,000 generations).

```{r gfs-mpe-per-end-wil}
pairwise.wilcox.test(x = performance$pop_fit_max, g = performance$Sigma , p.adjust.method = "bonferroni",
                     paired = FALSE, conf.int = FALSE, alternative = 'l')
```

### Activation gene coverage

Here we analyze the activation gene coverage for each parameter replicate on the multi-path exploration diagnostic.

#### Coverage over time

Activation gene coverage over time.

```{r gfs-mpe-act-ot, warning=FALSE}
lines = filter(gfs_ot, diagnostic == 'multipath_exploration') %>%
  group_by(Sigma, gen) %>%
  dplyr::summarise(
    min = min(uni_str_pos),
    mean = mean(uni_str_pos),
    max = max(uni_str_pos)
  )
ggplot(lines, aes(x=gen, y=mean, group = Sigma, fill =Sigma, color = Sigma, shape = Sigma)) +
  geom_ribbon(aes(ymin = min, ymax = max), alpha = 0.1) +
  geom_line(size = 0.5) +
  geom_point(data = filter(lines, gen %% 2000 == 0 & gen != 0), size = 1.5, stroke = 2.0, alpha = 1.0) +
  scale_y_continuous(
    name="Coverage",
    limits=c(-1, 101),
    breaks=seq(0,100, 20),
    labels=c("0", "20", "40", "60", "80", "100")
  ) +
  scale_x_continuous(
    name="Generations",
    limits=c(0, 50000),
    breaks=c(0, 10000, 20000, 30000, 40000, 50000),
    labels=c("0e+4", "1e+4", "2e+4", "3e+4", "4e+4", "5e+4")

  ) +
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  ggtitle("Activation gene coverage over time") +
  p_theme
```

#### End of 50,000 generations

Activation gene coverage in the final population (50,000 generations).

```{r gfs-mpe-act-end}
filter(gfs_ot, diagnostic == 'multipath_exploration' & gen == 50000)%>%
ggplot(., aes(x = Sigma, y = uni_str_pos, color = Sigma, fill = Sigma, shape = Sigma)) +
  geom_flat_violin(position = position_nudge(x = .2, y = 0), scale = 'width', alpha = 0.2) +
  geom_point(position = position_jitter(width = .1), size = 1.5, alpha = 1.0) +
  geom_boxplot(color = 'black', width = .2, outlier.shape = NA, alpha = 0.0) +
  scale_y_continuous(
    name="Coverage",
    limits=c(-1, 10),
    breaks=seq(0,10, 2),
    labels=c("0", "2", "4", "6", "8", "10")
  ) +
  scale_x_discrete(
    name="Sigma"
  )+
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  ggtitle("Final activation gene coverage") +
  p_theme

```

##### Stats

Summary statistics for the activation gene coverage in the final population (50,000 generations).

```{r gfs-mpe-act-end-sum}
performance = filter(gfs_ot, diagnostic == 'multipath_exploration' & gen == 50000)
group_by(performance, Sigma) %>%
dplyr::summarise(
  count = n(),
  na_cnt = sum(is.na(uni_str_pos)),
  min = min(uni_str_pos, na.rm = TRUE),
  median = median(uni_str_pos, na.rm = TRUE),
  mean = mean(uni_str_pos, na.rm = TRUE),
  max = max(uni_str_pos, na.rm = TRUE),
  IQR = IQR(uni_str_pos, na.rm = TRUE)
)
```

Kruskal–Wallis test provides evidence of statistical differences among activation gene coverage in the final population (50,000 generations).

```{r gfs-mpe-act-end-kru}
kruskal.test(uni_str_pos ~ Sigma, data = performance)
```

Results for post-hoc Wilcoxon rank-sum test with a Bonferroni correction on the activation gene coverage in the final population (50,000 generations).

```{r gfs-mpe-act-end-wil}
pairwise.wilcox.test(x = performance$uni_str_pos, g = performance$Sigma , p.adjust.method = "bonferroni",
                     paired = FALSE, conf.int = FALSE, alternative = 't')
```

### Multi-valley crossing

#### Performance over time

```{r gfs-mpe-val-per-ot}
lines =  filter(gfs_ot, diagnostic == 'multipath_exploration') %>%
  group_by(Sigma, gen) %>%
  dplyr::summarise(
    min = min(pop_fit_max),
    mean = mean(pop_fit_max),
    max = max(pop_fit_max)
  )
ggplot(lines, aes(x=gen, y=mean / DIMENSIONALITY, group = Sigma, fill = Sigma, color = Sigma, shape = Sigma)) +
  geom_ribbon(aes(ymin = min / DIMENSIONALITY, ymax = max / DIMENSIONALITY), alpha = 0.1) +
  geom_line(size = 0.5) +
  geom_point(data = filter(lines, gen %% 2000 == 0 & gen != 0), size = 1.5, stroke = 2.0, alpha = 1.0) +
  scale_y_continuous(
    name="Average trait score"
  ) +
  scale_x_continuous(
    name="Generations",
    limits=c(0, 50000),
    breaks=c(0, 10000, 20000, 30000, 40000, 50000),
    labels=c("0e+4", "1e+4", "2e+4", "3e+4", "4e+4", "5e+4")

  ) +
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  ggtitle("Best performance over time") +
  p_theme
```

#### Performance comparisons

```{r gfs-mpe-val-per-sli, warning=FALSE}
# 80% and final generation comparison
end = filter(gfs_ot_mvc, diagnostic == 'multipath_exploration' & gen == 50000)
end$Generation <- factor(end$gen)

mid = filter(gfs_ot_mvc, diagnostic == 'multipath_exploration' & gen == 40000)
mid$Generation <- factor(mid$gen)

mvc_p = ggplot(mid, aes(x = Sigma, y=pop_fit_max / DIMENSIONALITY, group = Sigma, shape = Generation)) +
  geom_point(col = mvc_col[1] , position = position_jitternudge(jitter.width = .03, nudge.x = -0.05), size = 2, alpha = 1.0) +
  geom_boxplot(position = position_nudge(x = -.15, y = 0), lwd = 0.7, col = mvc_col[1], fill = mvc_col[1], width = .1, outlier.shape = NA, alpha = 0.0) +

  geom_point(data = end, aes(x = Sigma, y=pop_fit_max / DIMENSIONALITY), col = mvc_col[2], position = position_jitternudge(jitter.width = .03, nudge.x = 0.05), size = 2, alpha = 1.0) +
  geom_boxplot(data = end, aes(x = Sigma, y=pop_fit_max / DIMENSIONALITY), position = position_nudge(x = .15, y = 0), lwd = 0.7, col = mvc_col[2], fill = mvc_col[2], width = .1, outlier.shape = NA, alpha = 0.0) +

  scale_y_continuous(
    name="Average trait score"
  ) +
  scale_x_discrete(
    name="Sigma"
  )+
  scale_shape_manual(values=c(0,1))+
  scale_colour_manual(values = c(mvc_col[1],mvc_col[2])) +
  p_theme

plot_grid(
  mvc_p +
    ggtitle("Performance comparisons") +
    theme(legend.position="none"),
  legend,
  nrow=2,
  rel_heights = c(1,.05),
  label_size = TSIZE
)
```

##### Stats

Summary statistics for the performance of the best performance at 40,000 and 50,000 generations.

```{r gfs-exp-mvc-per-sli-sum}
# 80% and final generation comparison
slices = filter(gfs_ot_mvc, diagnostic == 'multipath_exploration' & (gen == 50000 | gen == 40000))
slices$Generation <- factor(slices$gen, levels = c(50000,40000))
slices %>%
  group_by(Sigma, Generation) %>%
  dplyr::summarise(
    count = n(),
    na_cnt = sum(is.na(pop_fit_max  / DIMENSIONALITY)),
    min = min(pop_fit_max  / DIMENSIONALITY, na.rm = TRUE),
    median = median(pop_fit_max  / DIMENSIONALITY, na.rm = TRUE),
    mean = mean(pop_fit_max  / DIMENSIONALITY, na.rm = TRUE),
    max = max(pop_fit_max  / DIMENSIONALITY, na.rm = TRUE),
    IQR = IQR(pop_fit_max  / DIMENSIONALITY, na.rm = TRUE)
  )
```

Sigma 0.0
```{r gfs-exp-mvc-per-0}
wilcox.test(x = filter(slices, Sigma == 0.0 & Generation == 50000)$pop_fit_max,
            y = filter(slices, Sigma == 0.0 & Generation == 40000)$pop_fit_max,
            alternative = 't')
```

Sigma 0.1
```{r gfs-exp-mvc-per-01}
wilcox.test(x = filter(slices, Sigma == 0.1 & Generation == 50000)$pop_fit_max,
            y = filter(slices, Sigma == 0.1 & Generation == 40000)$pop_fit_max,
            alternative = 't')
```

Sigma 0.3
```{r gfs-exp-mvc-per-03}
wilcox.test(x = filter(slices, Sigma == 0.3 & Generation == 50000)$pop_fit_max,
            y = filter(slices, Sigma == 0.3 & Generation == 40000)$pop_fit_max,
            alternative = 't')
```

Sigma 0.6
```{r gfs-exp-mvc-per-06}
wilcox.test(x = filter(slices, Sigma == 0.6 & Generation == 50000)$pop_fit_max,
            y = filter(slices, Sigma == 0.6 & Generation == 40000)$pop_fit_max,
            alternative = 't')
```

Sigma 1.2
```{r gfs-exp-mvc-per-12}
wilcox.test(x = filter(slices, Sigma == 1.2 & Generation == 50000)$pop_fit_max,
            y = filter(slices, Sigma == 1.2 & Generation == 40000)$pop_fit_max,
            alternative = 't')
```

Sigma 2.5
```{r  gfs-exp-mvc-per-25}
wilcox.test(x = filter(slices, Sigma == 2.5 & Generation == 50000)$pop_fit_max,
            y = filter(slices, Sigma == 2.5 & Generation == 40000)$pop_fit_max,
            alternative = 't')
```

Sigma 5.0
```{r  gfs-exp-mvc-per-25}
wilcox.test(x = filter(slices, Sigma == 5.0 & Generation == 50000)$pop_fit_max,
            y = filter(slices, Sigma == 5.0 & Generation == 40000)$pop_fit_max,
            alternative = 't')
```

#### Activation gene coverage over time

```{r gfs-mpe-mvc-act-ot}
lines = filter(gfs_ot_mvc, diagnostic == 'multipath_exploration') %>%
  group_by(Sigma, gen) %>%
  dplyr::summarise(
    min = min(uni_str_pos),
    mean = mean(uni_str_pos),
    max = max(uni_str_pos)
  )
ggplot(lines, aes(x=gen, y=mean, group = Sigma, fill =Sigma, color = Sigma, shape = Sigma)) +
  geom_ribbon(aes(ymin = min, ymax = max), alpha = 0.1) +
  geom_line(size = 0.5) +
  geom_point(data = filter(lines, gen %% 2000 == 0 & gen != 0), size = 1.5, stroke = 2.0, alpha = 1.0) +
  scale_y_continuous(
    name="Coverage"
  ) +
  scale_x_continuous(
    name="Generations",
    limits=c(0, 50000),
    breaks=c(0, 10000, 20000, 30000, 40000, 50000),
    labels=c("0e+4", "1e+4", "2e+4", "3e+4", "4e+4", "5e+4")

  ) +
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  ggtitle("Activation gene coverage over time") +
  p_theme
```

#### Activation gene coverage comparison

Best performances in the population at 40,000 and 50,000 generations.

```{r gfs-mpe-mvc-act-sli, warning=FALSE}
# 80% and final generation comparison
end = filter(gfs_ot_mvc, diagnostic == 'multipath_exploration' & gen == 50000)
end$Generation <- factor(end$gen)

mid = filter(gfs_ot_mvc, diagnostic == 'multipath_exploration' & gen == 40000)
mid$Generation <- factor(mid$gen)

mvc_p = ggplot(mid, aes(x = Sigma, y=uni_str_pos, group = Sigma, shape = Generation)) +
  geom_point(col = mvc_col[1] , position = position_jitternudge(jitter.width = .03, nudge.x = -0.05), size = 2, alpha = 1.0) +
  geom_boxplot(position = position_nudge(x = -.15, y = 0), lwd = 0.7, col = mvc_col[1], fill = mvc_col[1], width = .1, outlier.shape = NA, alpha = 0.0) +

  geom_point(data = end, aes(x = Sigma, y=uni_str_pos), col = mvc_col[2], position = position_jitternudge(jitter.width = .03, nudge.x = 0.05), size = 2, alpha = 1.0) +
  geom_boxplot(data = end, aes(x = Sigma, y=uni_str_pos), position = position_nudge(x = .15, y = 0), lwd = 0.7, col = mvc_col[2], fill = mvc_col[2], width = .1, outlier.shape = NA, alpha = 0.0) +

  scale_y_continuous(
    name="Coverage",
  ) +
  scale_x_discrete(
    name="Sigma"
  )+
  scale_shape_manual(values=c(0,1))+
  scale_colour_manual(values = c(mvc_col[1],mvc_col[2])) +
  p_theme

plot_grid(
  mvc_p +
    ggtitle("Activation gene coverage over time") +
    theme(legend.position="none"),
  legend,
  nrow=2,
  rel_heights = c(1,.05),
  label_size = TSIZE
)
```

##### Stats

Summary statistics for the performance of the best performance at 40,000 and 50,000 generations.

```{r gfs-mpe-mvc-act-sli-sum}
slices = filter(gfs_ot_mvc, diagnostic == 'multipath_exploration' & (gen == 50000 | gen == 40000))
slices$Generation <- factor(slices$gen, levels = c(50000,40000))
slices %>%
  group_by(Sigma, Generation) %>%
  dplyr::summarise(
    count = n(),
    na_cnt = sum(is.na(uni_str_pos)),
    min = min(uni_str_pos, na.rm = TRUE),
    median = median(uni_str_pos, na.rm = TRUE),
    mean = mean(uni_str_pos, na.rm = TRUE),
    max = max(uni_str_pos, na.rm = TRUE),
    IQR = IQR(uni_str_pos, na.rm = TRUE)
  )

```

Sigma 0.0
```{r gfs-mpe-mvc-act-0}
wilcox.test(x = filter(slices, Sigma == 0.0 & Generation == 50000)$uni_str_pos,
            y = filter(slices, Sigma == 0.0 & Generation == 40000)$uni_str_pos,
            alternative = 't')
```

Sigma 0.1
```{r gfs-mpe-mvc-act-01}
wilcox.test(x = filter(slices, Sigma == 0.1 & Generation == 50000)$uni_str_pos,
            y = filter(slices, Sigma == 0.1 & Generation == 40000)$uni_str_pos,
            alternative = 't')
```

Sigma 0.3
```{r gfs-mpe-mvc-act-03}
wilcox.test(x = filter(slices, Sigma == 0.3 & Generation == 50000)$uni_str_pos,
            y = filter(slices, Sigma == 0.3 & Generation == 40000)$uni_str_pos,
            alternative = 't')
```

Sigma 0.6
```{r gfs-mpe-mvc-act-06}
wilcox.test(x = filter(slices, Sigma == 0.6 & Generation == 50000)$uni_str_pos,
            y = filter(slices, Sigma == 0.6 & Generation == 40000)$uni_str_pos,
            alternative = 't')
```

Sigma 1.2
```{r gfs-mpe-mvc-act-12}
wilcox.test(x = filter(slices, Sigma == 1.2 & Generation == 50000)$uni_str_pos,
            y = filter(slices, Sigma == 1.2 & Generation == 40000)$uni_str_pos,
            alternative = 't')
```

Sigma 2.5
```{r gfs-mpe-mvc-act-25}
wilcox.test(x = filter(slices, Sigma == 2.5 & Generation == 50000)$uni_str_pos,
            y = filter(slices, Sigma == 2.5 & Generation == 40000)$uni_str_pos,
            alternative = 't')
```

Sigma 5.0
```{r gfs-mpe-mvc-act-25}
wilcox.test(x = filter(slices, Sigma == 5.0 & Generation == 50000)$uni_str_pos,
            y = filter(slices, Sigma == 5.0 & Generation == 40000)$uni_str_pos,
            alternative = 't')
```