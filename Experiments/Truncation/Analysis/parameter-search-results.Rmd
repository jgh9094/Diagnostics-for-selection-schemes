# Truncation selection

We present the results from our parameter sweeep on truncation selection.
50 replicates are conducted for each truncation size `T` parameter value explored.

```{r, message=FALSE}
library(ggplot2)
library(cowplot)
library(dplyr)
library(PupillometryR)
```

These analyses were conducted in the following computing environment:

```{r}
print(version)
```

## Exploitation rate results

Here we present the results for **best performances** found by each genotypic fitness sharing sigma value replicate on the exploitation rate diagnostic.
Best performance found refers to the largest average trait score found in a given population.
Note that performance values fall between 0 and 100.

### Performance over time

Performance over time.

```{r, warning=FALSE}
problem <- filter(tru_ot, diagnostic == 'exploitation_rate')
lines = problem %>%
        group_by(T, gen) %>%
          dplyr::summarise(
            min = min(pop_fit_max),
            mean = mean(pop_fit_max),
            max = max(pop_fit_max)
          )
points = filter(lines, gen %% 2000 == 0 & gen != 0)

ot = ggplot(lines, aes(x=gen, y=mean / TRAITS, group = T, fill = T, color = T, shape = T)) +
  geom_ribbon(aes(ymin = min / TRAITS, ymax = max / TRAITS), alpha = 0.1) +
  geom_line(size = 0.5) +
  geom_point(data = points, size = 1.5, stroke = 2.0, alpha = 1.0) +
  scale_y_continuous(
    name="Average trait score",
    limits=c(-1, 101),
    breaks=seq(0,100, 20),
    labels=c("0", "20", "40", "60", "80", "100")
  ) +
  scale_x_continuous(
    name="Generations",
    limits=c(0, 50000),
    breaks=c(0, 10000, 20000, 30000, 40000, 50000),
    labels=c("0e+6", "1e+6", "2e+6", "3e+6", "4e+6", "5e+6")

  ) +
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  ggtitle("Best performance over time") +
  p_theme+
    guides(
    shape=guide_legend(nrow=1, title.position = "bottom"),
    color=guide_legend(nrow=1, title.position = "bottom"),
    fill=guide_legend(nrow=1, title.position = "bottom")
  ) +
  theme(
    legend.position = "bottom",
    legend.box="verticle",
    legend.justification="center",
    legend.title.align=0.5
  )

ot
```

```{r, echo = FALSE}
legend <- cowplot::get_legend(
  ot +
    guides(
      shape=guide_legend(nrow=1, title.position = "bottom"),
      color=guide_legend(nrow=1, title.position = "bottom"),
      fill=guide_legend(nrow=1, title.position = "bottom")
    ) +
    theme(
      legend.position = "top",
      legend.box="verticle",
      legend.justification="center",
      legend.title=element_blank()
    )
)
```

### Generation satisfactory solution found

The first generation a satisfactory solution is found throughout the 50,000 generations.

```{r}
ssf = filter(tru_ssf, diagnostic == 'exploitation_rate')

plot <- ggplot(ssf, aes(x = T, y = generation, color = T, fill = T, shape = T)) +
  geom_flat_violin(position = position_nudge(x = .2, y = 0), scale = 'width', alpha = 0.2) +
  geom_point(position = position_jitter(width = .1), size = 1.5, alpha = 1.0) +
  geom_boxplot(color = 'black', width = .2, outlier.shape = NA, alpha = 0.0) +
  scale_shape_manual(values=SHAPE)+
  scale_y_continuous(
    name="Generation",
    limits=c(0, 12000),
    breaks=c(0, 2000, 4000, 6000, 8000, 10000, 12000),
    labels=c("0e+6", "2e+6", "4e+6", "6e+6", "8e+6", "10e+6", "12e+6")
  ) +
  scale_x_discrete(
    name="T"
  ) +
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  p_theme

plot_grid(
  plot +
    ggtitle("Generation satisfactory solution found") +
    theme(legend.position="none"),
  legend,
  nrow=2,
  rel_heights = c(2,.2),
  label_size = TSIZE
)

```

#### Stats

Summary statistics for the first generation a satisfactory solution is found throughout the 50,000 generations.

```{r}
group_by(ssf, T) %>%
  dplyr::summarise(
    count = n(),
    na_cnt = sum(is.na(generation)),
    min = min(generation, na.rm = TRUE),
    median = median(generation, na.rm = TRUE),
    mean = mean(generation, na.rm = TRUE),
    max = max(generation, na.rm = TRUE),
    IQR = IQR(generation, na.rm = TRUE)
  )
```

Kruskal–Wallis test provides evidence of significant differences among the generation a satisfactory solution is first found.

```{r}
kruskal.test(generation ~ T,data = ssf)
```

Results for post-hoc Wilcoxon rank-sum test with a Bonferroni correction on the generation a satisfactory solution is first found. .

```{r}
pairwise.wilcox.test(x = ssf$generation, g = ssf$T , p.adjust.method = "bonferroni",
                     paired = FALSE, conf.int = FALSE, alternative = 'g')
```

## Ordered exploitation results

Here we present the results for **best performances** found by each genotypic fitness sharing sigma value replicate on the ordered exploitation diagnostic.
Best performance found refers to the largest average trait score found in a given population.
Note that performance values fall between 0 and 100.

### Performance over time

Performance over time.

```{r, warning=FALSE}
problem <- filter(tru_ot, diagnostic == 'ordered_exploitation')
lines = problem %>%
        group_by(T, gen) %>%
          dplyr::summarise(
            min = min(pop_fit_max),
            mean = mean(pop_fit_max),
            max = max(pop_fit_max)
          )
points = filter(lines, gen %% 2000 == 0 & gen != 0)

ot = ggplot(lines, aes(x=gen, y=mean / TRAITS, group = T, fill = T, color = T, shape = T)) +
  geom_ribbon(aes(ymin = min / TRAITS, ymax = max / TRAITS), alpha = 0.1) +
  geom_line(size = 0.5) +
  geom_point(data = points, size = 1.5, stroke = 2.0, alpha = 1.0) +
  scale_y_continuous(
    name="Average trait score",
    limits=c(-1, 101),
    breaks=seq(0,100, 20),
    labels=c("0", "20", "40", "60", "80", "100")
  ) +
  scale_x_continuous(
    name="Generations",
    limits=c(0, 50000),
    breaks=c(0, 10000, 20000, 30000, 40000, 50000),
    labels=c("0e+6", "1e+6", "2e+6", "3e+6", "4e+6", "5e+6")

  ) +
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  ggtitle("Best performance over time") +
  p_theme+
    guides(
    shape=guide_legend(nrow=1, title.position = "bottom"),
    color=guide_legend(nrow=1, title.position = "bottom"),
    fill=guide_legend(nrow=1, title.position = "bottom")
  ) +
  theme(
    legend.position = "bottom",
    legend.box="verticle",
    legend.justification="center",
    legend.title.align=0.5
  )

ot
```

```{r, echo = FALSE}
legend <- cowplot::get_legend(
  ot +
    guides(
      shape=guide_legend(nrow=1, title.position = "bottom"),
      color=guide_legend(nrow=1, title.position = "bottom"),
      fill=guide_legend(nrow=1, title.position = "bottom")
    ) +
    theme(
      legend.position = "top",
      legend.box="verticle",
      legend.justification="center",
      legend.title=element_blank()
    )
)
```

### Generation satisfactory solution found

The first generation a satisfactory solution is found throughout the 50,000 generations.

```{r}
ssf = filter(tru_ssf, diagnostic == 'ordered_exploitation')

plot <- ggplot(ssf, aes(x = T, y = generation, color = T, fill = T, shape = T)) +
  geom_flat_violin(position = position_nudge(x = .2, y = 0), scale = 'width', alpha = 0.2) +
  geom_point(position = position_jitter(width = .1), size = 1.5, alpha = 1.0) +
  geom_boxplot(color = 'black', width = .2, outlier.shape = NA, alpha = 0.0) +
  scale_shape_manual(values=SHAPE)+
  scale_y_continuous(
    name="Generation",
    limits=c(0, 60000),
    breaks=c(0, 10000, 20000, 30000, 40000, 50000, 60000),
    labels=c("0e+6", "1e+6", "2e+6", "3e+6", "4e+6", "5e+6", "Fail")
  ) +
  scale_x_discrete(
    name="T"
  ) +
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  p_theme

plot_grid(
  plot +
    ggtitle("Generation satisfactory solution found") +
    theme(legend.position="none"),
  legend,
  nrow=2,
  rel_heights = c(2,.2),
  label_size = TSIZE
)

```

#### Stats

Summary statistics for the first generation a satisfactory solution is found throughout the 50,000 generations.

```{r}
ssf = filter(ssf, T != 2)

group_by(ssf, T) %>%
  dplyr::summarise(
    count = n(),
    na_cnt = sum(is.na(generation)),
    min = min(generation, na.rm = TRUE),
    median = median(generation, na.rm = TRUE),
    mean = mean(generation, na.rm = TRUE),
    max = max(generation, na.rm = TRUE),
    IQR = IQR(generation, na.rm = TRUE)
  )
```

Kruskal–Wallis test provides evidence of significant differences among the first generation a satisfactory solution is found throughout the 50,000 generations.

```{r}
kruskal.test(generation ~ T, data = ssf)
```

Results for post-hoc Wilcoxon rank-sum test with a Bonferroni correction on the first generation a satisfactory solution is found throughout the 50,000 generations.

```{r}
pairwise.wilcox.test(x = ssf$generation, g = ssf$T , p.adjust.method = "bonferroni",
                     paired = FALSE, conf.int = FALSE, alternative = 'g')
```

## Contraditruy objectives diagnostic

Here we present the results for **satisfactory trait coverage** and **activation gene coverage** found by each genotypic fitness sharing sigma value replicate on the ordered exploitation diagnostic.
Satisfactruy trait coverage refers to the count of unique satisfied traits in the population, while activation gene coverage refers to the count of unique activation genes in the population.
Note that both coverage values fall between 0 and 100.

### Satisfactruy trait coverage

Satisfactruy trait coverage analysis.

#### Coverage over time

Satisfactruy trait coverage over time.

```{r, warning=FALSE}
problem <- filter(tru_ot, diagnostic == 'contradictory_objectives')
lines = problem %>%
        group_by(T, gen) %>%
          dplyr::summarise(
            min = min(pop_uni_obj),
            mean = mean(pop_uni_obj),
            max = max(pop_uni_obj)
          )
points = filter(lines, gen %% 2000 == 0 & gen != 0)

ot = ggplot(lines, aes(x=gen, y=mean, group = T, fill =T, color = T, shape = T)) +
  geom_ribbon(aes(ymin = min, ymax = max), alpha = 0.1) +
  geom_line(size = 0.5) +
  geom_point(data = points, size = 1.5, stroke = 2.0, alpha = 1.0) +
  scale_y_continuous(
    name="Coverage",
    limits=c(0, 5)
  ) +
  scale_x_continuous(
    name="Generations",
    limits=c(0, 50000),
    breaks=c(0, 10000, 20000, 30000, 40000, 50000),
    labels=c("0e+6", "1e+6", "2e+6", "3e+6", "4e+6", "5e+6")

  ) +
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  ggtitle("Satisfactruy trait coverage over time") +
  p_theme+
    guides(
    shape=guide_legend(nrow=1, title.position = "bottom"),
    color=guide_legend(nrow=1, title.position = "bottom"),
    fill=guide_legend(nrow=1, title.position = "bottom")
  ) +
  theme(
    legend.position = "bottom",
    legend.box="verticle",
    legend.justification="center",
    legend.title.align=0.5
  )

ot
```

```{r, echo = FALSE}
legend <- cowplot::get_legend(
  ot +
    guides(
      shape=guide_legend(nrow=1, title.position = "bottom"),
      color=guide_legend(nrow=1, title.position = "bottom"),
      fill=guide_legend(nrow=1, title.position = "bottom")
    ) +
    theme(
      legend.position = "top",
      legend.box="verticle",
      legend.justification="center",
      legend.title=element_blank()
    )
)
```

#### Best coverage throughout

Best satisfactory trait coverage throughout 50,000 generations.

```{r}
best = filter(tru_best, col == 'pop_uni_obj' & diagnostic == 'contradictory_objectives')

plot = ggplot(best, aes(x = T, y = val, color = T, fill = T, shape = T)) +
  geom_flat_violin(position = position_nudge(x = .2, y = 0), scale = 'width', alpha = 0.2) +
  geom_point(position = position_jitter(width = .1), size = 1.5, alpha = 1.0) +
  geom_boxplot(color = 'black', width = .2, outlier.shape = NA, alpha = 0.0) +
  scale_y_continuous(
    name="Coverage",
    limits=c(0, 5)
  ) +
  scale_x_discrete(
    name="T"
  )+
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  p_theme

plot_grid(
  plot +
    ggtitle("Best satisfactory trait coverage") +
    theme(legend.position="none"),
  legend,
  nrow=2,
  rel_heights = c(2,.2),
  label_size = TSIZE
)
```

##### Stats

Summary statistics for the best satisfactory trait coverage throughout 50,000 generations.

```{r}
group_by(best, T) %>%
  dplyr::summarise(
    count = n(),
    na_cnt = sum(is.na(val)),
    min = min(val, na.rm = TRUE),
    median = median(val, na.rm = TRUE),
    mean = mean(val, na.rm = TRUE),
    max = max(val, na.rm = TRUE),
    IQR = IQR(val, na.rm = TRUE)
  )
```

#### End of 50,000 generations

Satisfactruy trait coverage in the population at the end of 50,000 generations.

```{r}
end = filter(tru_end, diagnostic == 'contradictory_objectives')
plot = ggplot(end, aes(x = T, y = pop_uni_obj, color = T, fill = T, shape = T)) +
  geom_flat_violin(position = position_nudge(x = .2, y = 0), scale = 'width', alpha = 0.2) +
  geom_point(position = position_jitter(width = .1), size = 1.5, alpha = 1.0) +
  geom_boxplot(color = 'black', width = .2, outlier.shape = NA, alpha = 0.0) +
  scale_y_continuous(
    name="Coverage",
    limits=c(0, 5)
  ) +
  scale_x_discrete(
    name="T"
  )+
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  p_theme

plot_grid(
  plot +
    ggtitle("Final satisfactory trait coverage") +
    theme(legend.position="none"),
  legend,
  nrow=2,
  rel_heights = c(2,.3),
  label_size = TSIZE
)
```

##### Stats

Summary statistics for satisfactory trait coverage in the population at the end of 50,000 generations.

```{r}
group_by(end, T) %>%
  dplyr::summarise(
    count = n(),
    na_cnt = sum(is.na(pop_uni_obj)),
    min = min(pop_uni_obj, na.rm = TRUE),
    median = median(pop_uni_obj, na.rm = TRUE),
    mean = mean(pop_uni_obj, na.rm = TRUE),
    max = max(pop_uni_obj, na.rm = TRUE),
    IQR = IQR(pop_uni_obj, na.rm = TRUE)
  )
```

### Activation gene coverage

Here we analyze the activation gene coverage for each parameter replicate on the contradictory objectives diagnostic.

#### Coverage over time

Activation gene coverage over time.

```{r, warning=FALSE}
problem <- filter(tru_ot, diagnostic == 'contradictory_objectives')
lines = problem %>%
        group_by(T, gen) %>%
          dplyr::summarise(
            min = min(uni_str_pos),
            mean = mean(uni_str_pos),
            max = max(uni_str_pos)
          )
points = filter(lines, gen %% 2000 == 0 & gen != 0)

ot = ggplot(lines, aes(x=gen, y=mean, group = T, fill =T, color = T, shape = T)) +
  geom_ribbon(aes(ymin = min, ymax = max), alpha = 0.1) +
  geom_line(size = 0.5) +
  geom_point(data = points, size = 1.5, stroke = 2.0, alpha = 1.0) +
  scale_y_continuous(
    name="Coverage",
    limits=c(-1, 101),
    breaks=seq(0,100, 20),
    labels=c("0", "20", "40", "60", "80", "100")
  ) +
  scale_x_continuous(
    name="Generations",
    limits=c(0, 50000),
    breaks=c(0, 10000, 20000, 30000, 40000, 50000),
    labels=c("0e+6", "1e+6", "2e+6", "3e+6", "4e+6", "5e+6")

  ) +
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  ggtitle("Activation gene coverage over time") +
  p_theme+
    guides(
    shape=guide_legend(nrow=1, title.position = "bottom"),
    color=guide_legend(nrow=1, title.position = "bottom"),
    fill=guide_legend(nrow=1, title.position = "bottom")
  ) +
  theme(
    legend.position = "bottom",
    legend.box="verticle",
    legend.justification="center",
    legend.title.align=0.5
  )

ot
```

#### End of 50,000 generations

Activation gene coverage in the population at the end of 50,000 generations.

```{r}
end = filter(tru_end, diagnostic == 'contradictory_objectives')
plot = ggplot(end, aes(x = T, y = uni_str_pos, color = T, fill = T, shape = T)) +
  geom_flat_violin(position = position_nudge(x = .2, y = 0), scale = 'width', alpha = 0.2) +
  geom_point(position = position_jitter(width = .1), size = 1.5, alpha = 1.0) +
  geom_boxplot(color = 'black', width = .2, outlier.shape = NA, alpha = 0.0) +
  scale_y_continuous(
    name="Coverage",
    limits=c(0, 5)
  ) +
  scale_x_discrete(
    name="T"
  )+
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  p_theme

plot_grid(
  plot +
    ggtitle("Final activation gene coverage") +
    theme(legend.position="none"),
  legend,
  nrow=2,
  rel_heights = c(2,.2),
  label_size = TSIZE
)
```

##### Stats

Summary statistics for activation gene coverage in the population at the end of 50,000 generations.

```{r}
group_by(end, T) %>%
  dplyr::summarise(
    count = n(),
    na_cnt = sum(is.na(uni_str_pos)),
    min = min(uni_str_pos, na.rm = TRUE),
    median = median(uni_str_pos, na.rm = TRUE),
    mean = mean(uni_str_pos, na.rm = TRUE),
    max = max(uni_str_pos, na.rm = TRUE),
    IQR = IQR(uni_str_pos, na.rm = TRUE)
  )
```

## Multi-path exploration results

Here we present the results for **best performances** and **activation gene coverage** found by each genotypic fitness sharing sigma value replicate on the multi-path exploration diagnostic.
Best performance found refers to the largest average trait score found in a given population, while activation gene coverage refers to the count of unique activation genes in the population.
Note that both values fall between 0 and 100.

### Performance

Here we analyze the performances for each parameter replicate on the multi-path exploration diagnostic.

#### Performance over time

Performance over time.

```{r, warning=FALSE}
problem <- filter(tru_ot, diagnostic == 'multipath_exploration')
lines = problem %>%
        group_by(T, gen) %>%
          dplyr::summarise(
            min = min(pop_fit_max),
            mean = mean(pop_fit_max),
            max = max(pop_fit_max)
          )
points = filter(lines, gen %% 2000 == 0 & gen != 0)

ot = ggplot(lines, aes(x=gen, y=mean / TRAITS, group = T, fill = T, color = T, shape = T)) +
  geom_ribbon(aes(ymin = min / TRAITS, ymax = max / TRAITS), alpha = 0.1) +
  geom_line(size = 0.5) +
  geom_point(data = points, size = 1.5, stroke = 2.0, alpha = 1.0) +
  scale_y_continuous(
    name="Average trait score",
    limits=c(-1, 101),
    breaks=seq(0,100, 20),
    labels=c("0", "20", "40", "60", "80", "100")
  ) +
  scale_x_continuous(
    name="Generations",
    limits=c(0, 50000),
    breaks=c(0, 10000, 20000, 30000, 40000, 50000),
    labels=c("0e+6", "1e+6", "2e+6", "3e+6", "4e+6", "5e+6")

  ) +
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  ggtitle("Best performance over time") +
  p_theme+
    guides(
    shape=guide_legend(nrow=1, title.position = "bottom"),
    color=guide_legend(nrow=1, title.position = "bottom"),
    fill=guide_legend(nrow=1, title.position = "bottom")
  ) +
  theme(
    legend.position = "bottom",
    legend.box="verticle",
    legend.justification="center",
    legend.title.align=0.5
  )

ot
```

```{r, echo = FALSE}
legend <- cowplot::get_legend(
  ot +
    guides(
      shape=guide_legend(nrow=1, title.position = "bottom"),
      color=guide_legend(nrow=1, title.position = "bottom"),
      fill=guide_legend(nrow=1, title.position = "bottom")
    ) +
    theme(
      legend.position = "top",
      legend.box="verticle",
      legend.justification="center",
      legend.title=element_blank()
    )
)
```

#### Best performance throughout

Here we plot the performance of the best performing solution found throughout 50,000 generations.

```{r}
best = filter(tru_best, col == 'pop_fit_max' & diagnostic == 'multipath_exploration')

plot = ggplot(best, aes(x = T, y = val / TRAITS, color = T, fill = T, shape = T)) +
  geom_flat_violin(position = position_nudge(x = .2, y = 0), scale = 'width', alpha = 0.2) +
  geom_point(position = position_jitter(width = .1), size = 1.5, alpha = 1.0) +
  geom_boxplot(color = 'black', width = .2, outlier.shape = NA, alpha = 0.0) +
  scale_y_continuous(
    name="Average trait score",
    limits=c(-1, 101),
    breaks=seq(0,100, 20),
    labels=c("0", "20", "40", "60", "80", "100")
  ) +
  scale_x_discrete(
    name="T"
  )+
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  p_theme

plot_grid(
  plot +
    ggtitle("Best performance throughout") +
    theme(legend.position="none"),
  legend,
  nrow=2,
  rel_heights = c(2,.3),
  label_size = TSIZE
)
```

##### Stats

Summary statistics for the performance of the best performing solution found throughout 50,000 generations.

```{r}
group_by(best, T) %>%
  dplyr::summarise(
    count = n(),
    na_cnt = sum(is.na(val)),
    min = min(val / TRAITS, na.rm = TRUE),
    median = median(val / TRAITS, na.rm = TRUE),
    mean = mean(val / TRAITS, na.rm = TRUE),
    max = max(val / TRAITS, na.rm = TRUE),
    IQR = IQR(val / TRAITS, na.rm = TRUE)
  )
```

Kruskal–Wallis test provides evidence of no statistical differences among the best performing solution found throughout 50,000 generations.

```{r}
kruskal.test(val ~ T,data = best)
```

#### End of 50,000 generations

Best performance in the population at the end of 50,000 generations.

```{r}
end = filter(tru_end, diagnostic == 'multipath_exploration')
plot = ggplot(end, aes(x = T, y = pop_fit_max / TRAITS, color = T, fill = T, shape = T)) +
  geom_flat_violin(position = position_nudge(x = .2, y = 0), scale = 'width', alpha = 0.2) +
  geom_point(position = position_jitter(width = .1), size = 1.5, alpha = 1.0) +
  geom_boxplot(color = 'black', width = .2, outlier.shape = NA, alpha = 0.0) +
  scale_y_continuous(
    name="Average trait score",
    limits=c(-1, 101),
    breaks=seq(0,100, 20),
    labels=c("0", "20", "40", "60", "80", "100")
  ) +
  scale_x_discrete(
    name="T"
  )+
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  p_theme

plot_grid(
  plot +
    ggtitle("Final performance") +
    theme(legend.position="none"),
  legend,
  nrow=2,
  rel_heights = c(2,.3),
  label_size = TSIZE
)
```

##### Stats

Summary statistics for the best performance in the population at the end of 50,000 generations.

```{r}
group_by(end, T) %>%
  dplyr::summarise(
    count = n(),
    na_cnt = sum(is.na(pop_fit_max / TRAITS)),
    min = min(pop_fit_max / TRAITS, na.rm = TRUE),
    median = median(pop_fit_max / TRAITS, na.rm = TRUE),
    mean = mean(pop_fit_max / TRAITS, na.rm = TRUE),
    max = max(pop_fit_max / TRAITS, na.rm = TRUE),
    IQR = IQR(pop_fit_max / TRAITS, na.rm = TRUE)
  )
```

Kruskal–Wallis test provides evidence of statistical differences among best performance in the population at the end of 50,000 generations.

```{r}
kruskal.test(pop_fit_max ~ T, data = end)
```

Results for post-hoc Wilcoxon rank-sum test with a Bonferroni correction on the best performance in the population at the end of 50,000 generations.

```{r}
pairwise.wilcox.test(x = end$pop_fit_max, g = end$T , p.adjust.method = "bonferroni",
                     paired = FALSE, conf.int = FALSE, alternative = 'l')
```

### Activation gene coverage

Here we analyze the activation gene coverage for each parameter replicate on the multi-path exploration diagnostic.

#### Coverage over time

Activation gene coverage over time.

```{r, warning=FALSE}
problem <- filter(tru_ot, diagnostic == 'multipath_exploration')
lines = problem %>%
        group_by(T, gen) %>%
          dplyr::summarise(
            min = min(uni_str_pos),
            mean = mean(uni_str_pos),
            max = max(uni_str_pos)
          )
points = filter(lines, gen %% 2000 == 0 & gen != 0)

ot = ggplot(lines, aes(x=gen, y=mean, group = T, fill =T, color = T, shape = T)) +
  geom_ribbon(aes(ymin = min, ymax = max), alpha = 0.1) +
  geom_line(size = 0.5) +
  geom_point(data = points, size = 1.5, stroke = 2.0, alpha = 1.0) +
  scale_y_continuous(
    name="Coverage",
    limits=c(-1, 101),
    breaks=seq(0,100, 20),
    labels=c("0", "20", "40", "60", "80", "100")
  ) +
  scale_x_continuous(
    name="Generations",
    limits=c(0, 50000),
    breaks=c(0, 10000, 20000, 30000, 40000, 50000),
    labels=c("0e+6", "1e+6", "2e+6", "3e+6", "4e+6", "5e+6")

  ) +
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  ggtitle("Activation gene coverage over time") +
  p_theme+
    guides(
    shape=guide_legend(nrow=1, title.position = "bottom"),
    color=guide_legend(nrow=1, title.position = "bottom"),
    fill=guide_legend(nrow=1, title.position = "bottom")
  ) +
  theme(
    legend.position = "bottom",
    legend.box="verticle",
    legend.justification="center",
    legend.title.align=0.5
  )

ot
```

#### End of 50,000 generations

Activation gene coverage in the population at the end of 50,000 generations.

```{r}
end = filter(tru_end, diagnostic == 'multipath_exploration')
plot = ggplot(end, aes(x = T, y = uni_str_pos, color = T, fill = T, shape = T)) +
  geom_flat_violin(position = position_nudge(x = .2, y = 0), scale = 'width', alpha = 0.2) +
  geom_point(position = position_jitter(width = .1), size = 1.5, alpha = 1.0) +
  geom_boxplot(color = 'black', width = .2, outlier.shape = NA, alpha = 0.0) +
  scale_y_continuous(
    name="Coverage",
    limits=c(-1, 10),
    breaks=seq(0,10, 2),
    labels=c("0", "2", "4", "6", "8", "10")
  ) +
  scale_x_discrete(
    name="T"
  )+
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  p_theme

plot_grid(
  plot +
    ggtitle("Final activation gene coverage") +
    theme(legend.position="none"),
  legend,
  nrow=2,
  rel_heights = c(2,.3),
  label_size = TSIZE
)
```

##### Stats

Summary statistics for the activation gene coverage in the population at the end of 50,000 generations.

```{r}
group_by(end, T) %>%
  dplyr::summarise(
    count = n(),
    na_cnt = sum(is.na(uni_str_pos)),
    min = min(uni_str_pos, na.rm = TRUE),
    median = median(uni_str_pos, na.rm = TRUE),
    mean = mean(uni_str_pos, na.rm = TRUE),
    max = max(uni_str_pos, na.rm = TRUE),
    IQR = IQR(uni_str_pos, na.rm = TRUE)
  )
```

Kruskal–Wallis test provides evidence of statistical differences among activation gene coverage in the population at the end of 50,000 generations.

```{r}
kruskal.test(uni_str_pos ~ T, data = end)
```

Results for post-hoc Wilcoxon rank-sum test with a Bonferroni correction on the activation gene coverage in the population at the end of 50,000 generations.

```{r}
pairwise.wilcox.test(x = end$uni_str_pos, g = end$T , p.adjust.method = "bonferroni",
                     paired = FALSE, conf.int = FALSE, alternative = 't')
```

## Multi-valley crossing results

Here we present the results for the **best performances** and **best gene value** generated by each truncation selection replicate on the multi-valley crossing diagnostic.
Best performance found refers to the largest average trait score found in a given population.
Best gene value refers to maximum gene value found in the population; this gives us a range of values in [0.0, 100.0].
50 replicates are conducted for each truncation size parameter value explored.

### Performance

Here we analyze the performances for each parameter replicate on the multi-valley crossing diagnostic.

#### Performance over time

Performance over time.

```{r tru-mvc-per-ot, warning=FALSE}
lines = filter(tru_ot, diagnostic == 'multivalley_crossing') %>%
  group_by(T, gen) %>%
  dplyr::summarise(
    min = min(pop_fit_max),
    mean = mean(pop_fit_max),
    max = max(pop_fit_max)
  )
points = filter(lines, gen %% 2000 == 0 & gen != 0)

ot = ggplot(lines, aes(x=gen, y=mean / TRAITS, group = T, fill = T, color = T, shape = T)) +
  geom_ribbon(aes(ymin = min / TRAITS, ymax = max / TRAITS), alpha = 0.1) +
  geom_line(size = 0.5) +
  geom_point(data = points, size = 1.5, stroke = 2.0, alpha = 1.0) +
  scale_y_continuous(
    name="Average trait score",
    limits=c(-1, 21),
    breaks=seq(0,20, 5),
    labels=c("0", "5", "10", "15", "20")
  ) +
  scale_x_continuous(
    name="Generations",
    limits=c(0, 50000),
    breaks=c(0, 10000, 20000, 30000, 40000, 50000),
    labels=c("0e+6", "1e+6", "2e+6", "3e+6", "4e+6", "5e+6")

  ) +
  ggtitle("Best performance over time") +
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  p_theme

ot
```

```{r tru-mvc-per-lgd, echo = FALSE}
legend <- cowplot::get_legend(
  ot +
    guides(
      shape=guide_legend(nrow=2, title.position = "bottom"),
      color=guide_legend(nrow=2, title.position = "bottom"),
      fill=guide_legend(nrow=2, title.position = "bottom")
    ) +
    theme(
      legend.position = "top",
      legend.box="verticle",
      legend.justification="center"
    )
)
```

#### Best performance throughout

The best performance found throughout 50,000 generations.

```{r tru-mvc-per-bst}
best = filter(tru_best, col == 'pop_fit_max' & diagnostic == 'multivalley_crossing')
plot =  ggplot(best, aes(x = T, y = val / TRAITS, color = T, fill = T, shape = T)) +
          geom_flat_violin(position = position_nudge(x = .2, y = 0), scale = 'width', alpha = 0.2) +
          geom_point(position = position_jitter(width = .1), size = 1.5, alpha = 1.0) +
          geom_boxplot(color = 'black', width = .2, outlier.shape = NA, alpha = 0.0) +
          guides(fill = "none",color = 'none', shape = 'none') +
          scale_y_continuous(
            name="Average trait score",
            limits=c(-1, 21),
            breaks=seq(0,20, 5),
            labels=c("0", "5", "10", "15", "20")
          ) +
          scale_x_discrete(
            name="T"
          )+
          scale_shape_manual(values=SHAPE)+
          scale_colour_manual(values = cb_palette, ) +
          scale_fill_manual(values = cb_palette) +
          p_theme

plot_grid(
  plot +
    ggtitle("Best performance throughout") +
    theme(legend.position="none"),
  legend,
  nrow=2,
  rel_heights = c(2,.55),
  label_size = TSIZE
)
```

##### Stats

Summary statistics for the best performance found throughout 50,000 generations.

```{r tru-mvc-per-bst-sum}
best$T = factor(best$T, levels = c(1,2,4,8,16,32,64,128,256))
group_by(best, T) %>%
  dplyr::summarise(
    count = n(),
    na_cnt = sum(is.na(val)),
    min = min(val, na.rm = TRUE),
    median = median(val, na.rm = TRUE),
    mean = mean(val, na.rm = TRUE),
    max = max(val, na.rm = TRUE),
    IQR = IQR(val, na.rm = TRUE)
  )
```

Kruskal–Wallis test provides evidence of significant differences among size values on the best performance found throughout 50,000 generations

```{r tru-mvc-per-bst-kru}
kruskal.test(val ~ T, data = best)
```

Results for post-hoc Wilcoxon rank-sum test with a Bonferroni correction on the best performance found throughout 50,000 generations.

```{r tru-mvc-per-bst-wil}
pairwise.wilcox.test(x = best$val, g = best$T, p.adjust.method = "bonferroni",
                     paired = FALSE, conf.int = FALSE, alternative = 't')
```

#### End of 50,000 generations

Best performance in the population at the end of 50,000 generations.

```{r tru-mvc-per-end}
end = filter(tru_end, diagnostic == 'multivalley_crossing')
plot = ggplot(end, aes(x = T, y = pop_fit_max / TRAITS, group = T, fill =T, color = T, shape = T)) +
  geom_flat_violin(position = position_nudge(x = .3), alpha = 0.2) +
  geom_point(position = position_jitter(width = .1), size = 1.5, alpha = 10.8) +
  geom_boxplot(width = .1, outlier.shape = NA, alpha = 0.1, col = "black") +
  scale_y_continuous(
    name="Average trait score",
    limits=c(-1, 21),
    breaks=seq(0,20, 5),
    labels=c("0", "5", "10", "15", "20")
  ) +
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  p_theme

plot_grid(
  plot +
    ggtitle("Final performance") +
    theme(legend.position="none"),
  legend,
  nrow=2,
  rel_heights = c(2,.55),
  label_size = TSIZE
)
```

##### Stats

Summary statistics for the best performance found throughout 50,000 generations.

```{r tru-mvc-per-end-sum}
end$T = factor(end$T, levels = c(1,2,4,8,16,32,64,128,256))
group_by(end, T) %>%
  dplyr::summarise(
    count = n(),
    na_cnt = sum(is.na(pop_fit_max)),
    min = min(pop_fit_max, na.rm = TRUE),
    median = median(pop_fit_max, na.rm = TRUE),
    mean = mean(pop_fit_max, na.rm = TRUE),
    max = max(pop_fit_max, na.rm = TRUE),
    IQR = IQR(pop_fit_max, na.rm = TRUE)
  )
```

Kruskal–Wallis test provides evidence of no significant differences among size values on the best performance found at the end of 50,000 generations.

```{r tru-mvc-per-end-kru}
kruskal.test(pop_fit_max ~ T, data = end)
```

### Best gene value

Here we analyze the gene values for each parameter replicate on the multi-valley crossing diagnostic.

#### Gene value over time

Best gene value over time.

```{r tru-mvc-gne-ot, warning=FALSE}
lines = filter(tru_ot, diagnostic == 'multivalley_crossing') %>%
  group_by(T, gen) %>%
  dplyr::summarise(
    min = min(pop_max_gene),
    mean = mean(pop_max_gene),
    max = max(pop_max_gene)
  )
points = filter(lines, gen %% 2000 == 0 & gen != 0)

ot = ggplot(lines, aes(x=gen, y=mean, group = T, fill = T, color = T, shape = T)) +
  geom_ribbon(aes(ymin = min, ymax = max), alpha = 0.1) +
  geom_line(size = 0.5) +
  geom_point(data = points, size = 1.5, stroke = 2.0, alpha = 1.0) +
  scale_y_continuous(
    name="Max gene value",
    limits=c(-1, 31),
    breaks=seq(0,30, 10),
    labels=c("0", "10", "20", "30")
  ) +
  scale_x_continuous(
    name="Generations",
    limits=c(0, 50000),
    breaks=c(0, 10000, 20000, 30000, 40000, 50000),
    labels=c("0e+6", "1e+6", "2e+6", "3e+6", "4e+6", "5e+6")

  ) +
  ggtitle("Best gene value over time") +
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  p_theme

ot
```

```{r tru-mvc-gne-lgd, echo = FALSE}
legend <- cowplot::get_legend(
  ot +
    guides(
      shape=guide_legend(nrow=2, title.position = "bottom"),
      color=guide_legend(nrow=2, title.position = "bottom"),
      fill=guide_legend(nrow=2, title.position = "bottom")
    ) +
    theme(
      legend.position = "top",
      legend.box="verticle",
      legend.justification="center"
    )
)
```

#### Best gene value throughout

The best gene value found throughout 50,000 generations.

```{r tru-mvc-gne-bst}
best = filter(tru_best, col == 'pop_max_gene' & diagnostic == 'multivalley_crossing')
plot =  ggplot(best, aes(x = T, y = val, color = T, fill = T, shape = T)) +
          geom_flat_violin(position = position_nudge(x = .2, y = 0), scale = 'width', alpha = 0.2) +
          geom_point(position = position_jitter(width = .1), size = 1.5, alpha = 1.0) +
          geom_boxplot(color = 'black', width = .2, outlier.shape = NA, alpha = 0.0) +
          guides(fill = "none",color = 'none', shape = 'none') +
          scale_y_continuous(
            name="Max gene value",
            limits=c(-1, 31),
            breaks=seq(0,30, 10),
            labels=c("0", "10", "20", "30")
          ) +
          scale_x_discrete(
            name="T"
          )+
          scale_shape_manual(values=SHAPE)+
          scale_colour_manual(values = cb_palette, ) +
          scale_fill_manual(values = cb_palette) +
          p_theme

plot_grid(
  plot +
    ggtitle("Best gene value throughout") +
    theme(legend.position="none"),
  legend,
  nrow=2,
  rel_heights = c(2,.55),
  label_size = TSIZE
)
```

##### Stats

Summary statistics for the best gene value found throughout 50,000 generations.

```{r tru-mvc-gne-bst-sum}
best$T = factor(best$T, levels = c(1,2,4,8,16,32,64,128,256))
group_by(best, T) %>%
  dplyr::summarise(
    count = n(),
    na_cnt = sum(is.na(val)),
    min = min(val, na.rm = TRUE),
    median = median(val, na.rm = TRUE),
    mean = mean(val, na.rm = TRUE),
    max = max(val, na.rm = TRUE),
    IQR = IQR(val, na.rm = TRUE)
  )
```

Kruskal–Wallis test provides evidence of significant differences among size values on the best gene value found throughout 50,000 generations

```{r tru-mvc-gne-bst-kru}
kruskal.test(val ~ T, data = best)
```

Results for post-hoc Wilcoxon rank-sum test with a Bonferroni correction on the best gene value found throughout 50,000 generations.

```{r tru-mvc-gne-bst-wil}
pairwise.wilcox.test(x = best$val, g = best$T, p.adjust.method = "bonferroni",
                     paired = FALSE, conf.int = FALSE, alternative = 'g')
```

#### End of 50,000 generations

Best gene value in the population at the end of 50,000 generations.

```{r tru-mvc-gne-end}
end = filter(tru_end, diagnostic == 'multivalley_crossing')
plot = ggplot(end, aes(x = T, y = pop_max_gene, group = T, fill =T, color = T, shape = T)) +
  geom_flat_violin(position = position_nudge(x = .3), alpha = 0.2) +
  geom_point(position = position_jitter(width = .1), size = 1.5, alpha = 10.8) +
  geom_boxplot(width = .1, outlier.shape = NA, alpha = 0.1, col = "black") +
  scale_y_continuous(
    name="Max gene value",
    limits=c(-1, 31),
    breaks=seq(0,30, 10),
    labels=c("0", "10", "20", "30")
  ) +
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  p_theme

plot_grid(
  plot +
    ggtitle("Final gene value") +
    theme(legend.position="none"),
  legend,
  nrow=2,
  rel_heights = c(2,.55),
  label_size = TSIZE
)
```

##### Stats

Summary statistics for the best gene value found at the end of 50,000 generations.

```{r tru-mvc-gne-end-sum}
end$T = factor(end$T, levels = c(1,2,4,8,16,32,64,128,256))
group_by(end, T) %>%
  dplyr::summarise(
    count = n(),
    na_cnt = sum(is.na(pop_max_gene)),
    min = min(pop_max_gene, na.rm = TRUE),
    median = median(pop_max_gene, na.rm = TRUE),
    mean = mean(pop_max_gene, na.rm = TRUE),
    max = max(pop_max_gene, na.rm = TRUE),
    IQR = IQR(pop_max_gene, na.rm = TRUE)
  )
```

Kruskal–Wallis test provides evidence of no significant differences among size values on the best gene value found at the end of 50,000 generations.

```{r tru-mvc-gne-end-kru}
kruskal.test(pop_max_gene ~ T, data = end)
```