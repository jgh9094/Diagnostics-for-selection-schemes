# Contradictory objectives results

Here we present the results for the **satisfactory trait corverage** and **activation gene coverage** generated by each selection scheme replicate on the contradictory objectives diagnostic.
Note both of these values are gathered at the population-level.
Activation gene coverage refers to the count of unique activation genes in a given population; this gives us a range of integers between 0 and 100.
Satisfactory trait coverage refers to the count of unique satisfied traits in a given population; this gives us a range of integers between 0 and 100.

## Analysis dependencies

```{r con-libs, message=FALSE}
library(ggplot2)
library(cowplot)
library(dplyr)
library(PupillometryR)
```

## Setup

These analyses were conducted in the following computing environment:

```{r con-ver}
print(version)
```

## Satisfactory trait coverage

Satisfactory trait coverage analysis.

### Coverage over time

Satisfactory trait coverage over time.

```{r con-sat-ot, warning=FALSE}
contradictory_objectives = filter(cc_over_time, diagnostic == 'contradictory_objectives')
lines = contradictory_objectives %>%
        group_by(`Selection\nScheme`, gen) %>%
          dplyr::summarise(
            min = min(pop_uni_obj),
            mean = mean(pop_uni_obj),
            max = max(pop_uni_obj)
          )
points = filter(lines, gen %% 2000 == 0 & gen != 0)

ot = ggplot(lines, aes(x=gen, y=mean, group = `Selection\nScheme`, fill =`Selection\nScheme`, color = `Selection\nScheme`, shape = `Selection\nScheme`)) +
  geom_ribbon(aes(ymin = min, ymax = max), alpha = 0.1) +
  geom_line(size = 0.5) +
  geom_point(data = points, size = 1.5, stroke = 2.0, alpha = 1.0) +
  scale_y_continuous(
    name="Coverage",
    limits=c(-1, 101),
    breaks=seq(0,100, 20),
    labels=c("0", "20", "40", "60", "80", "100")
  ) +
  scale_x_continuous(
    name="Generations",
    limits=c(0, 50000),
    breaks=c(0, 10000, 20000, 30000, 40000, 50000),
    labels=c("0e+6", "1e+6", "2e+6", "3e+6", "4e+6", "5e+6")

  ) +
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  ggtitle("Satisfactory trait coverage over time") +
  p_theme+
    guides(
    shape=guide_legend(ncol=2, title.position = "bottom"),
    color=guide_legend(ncol=2, title.position = "bottom"),
    fill=guide_legend(ncol=2, title.position = "bottom")
  ) +
  theme(
    legend.position = "bottom",
    legend.box="verticle",
    legend.justification="center",
    legend.title=element_blank()
  )

ot
```

```{r con-sat-lgd, echo = FALSE}
legend <- cowplot::get_legend(
  ot +
    guides(
      shape=guide_legend(ncol=2, title.position = "bottom"),
      color=guide_legend(ncol=2, title.position = "bottom"),
      fill=guide_legend(ncol=2, title.position = "bottom")
    ) +
    theme(
      legend.position = "top",
      legend.box="verticle",
      legend.justification="center",
      legend.title=element_blank()
    )
)
```

### Best coverage throughout

Best satisfactory trait coverage throughout 50,000 generations.

```{r con-sat-bst}
best = filter(cc_best, col == 'pop_uni_obj' & diagnostic == 'contradictory_objectives')
plot = ggplot(best, aes(x = acron, y = val, color = acron, fill = acron, shape = acron)) +
  geom_flat_violin(position = position_nudge(x = .2, y = 0), scale = 'width', alpha = 0.2) +
  geom_point(position = position_jitter(width = .1), size = 1.5, alpha = 1.0) +
  geom_boxplot(color = 'black', width = .2, outlier.shape = NA, alpha = 0.0) +
  scale_y_continuous(
    name="Coverage",
    limits=c(-1, 101),
    breaks=seq(0,100, 20),
    labels=c("0", "20", "40", "60", "80", "100")
  ) +
  scale_x_discrete(
    name="Scheme"
  )+
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  p_theme

plot_grid(
  plot +
    ggtitle("Best satisfactory trait coverage") +
    theme(legend.position="none"),
  legend,
  nrow=2,
  rel_heights = c(2,.55),
  label_size = TSIZE
)
```

#### Stats

Summary statistics for the best satisfactory trait coverage throughout 50,000 generations.

```{r con-sat-sum}
best$acron = factor(best$acron, levels = c('nds', 'lex', 'pfs', 'gfs', 'tor', 'tru', 'nov', 'ran'))
group_by(best, acron) %>%
  dplyr::summarise(
    count = n(),
    na_cnt = sum(is.na(val)),
    min = min(val, na.rm = TRUE),
    median = median(val, na.rm = TRUE),
    mean = mean(val, na.rm = TRUE),
    max = max(val, na.rm = TRUE),
    IQR = IQR(val, na.rm = TRUE)
  )
```

Kruskal–Wallis test provides evidence of difference among satisfactory trait coverage throughout 50,000 generations.

```{r con-sat-kru}
kruskal.test(val ~ acron,data = best)
```

Results for post-hoc Wilcoxon rank-sum test with a Bonferroni correction on satisfactory trait coverage throughout 50,000 generations.

```{r con-sat-wil}
pairwise.wilcox.test(x = best$val, g = best$acron, p.adjust.method = "bonferroni",
                     paired = FALSE, conf.int = FALSE, alternative = 'l')
```

### End of 50,000 generations

Satisfactory trait coverage in the population at the end of 50,000 generations.

```{r con-sat-end}
end = filter(cc_end, diagnostic == 'contradictory_objectives')
plot = ggplot(end, aes(x = acron, y = pop_uni_obj, color = acron, fill = acron, shape = acron)) +
  geom_flat_violin(position = position_nudge(x = .2, y = 0), scale = 'width', alpha = 0.2) +
  geom_point(position = position_jitter(width = .1), size = 1.5, alpha = 1.0) +
  geom_boxplot(color = 'black', width = .2, outlier.shape = NA, alpha = 0.0) +
  scale_y_continuous(
    name="Coverage",
    limits=c(-1, 101),
    breaks=seq(0,100, 20),
    labels=c("0", "20", "40", "60", "80", "100")
  ) +
  scale_x_discrete(
    name="Scheme"
  )+
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  p_theme

plot_grid(
  plot +
    ggtitle("Final satisfactory trait coverage") +
    theme(legend.position="none"),
  legend,
  nrow=2,
  rel_heights = c(2,.55),
  label_size = TSIZE
)
```

#### Stats

Summary statistics for satisfactory trait coverage in the population at the end of 50,000 generations.

```{r con-sat-end-sum}
end$acron = factor(end$acron, levels = c('nds', 'lex', 'pfs', 'gfs', 'tor', 'tru', 'nov', 'ran'))
group_by(end, acron) %>%
  dplyr::summarise(
    count = n(),
    na_cnt = sum(is.na(pop_uni_obj)),
    min = min(pop_uni_obj, na.rm = TRUE),
    median = median(pop_uni_obj, na.rm = TRUE),
    mean = mean(pop_uni_obj, na.rm = TRUE),
    max = max(pop_uni_obj, na.rm = TRUE),
    IQR = IQR(pop_uni_obj, na.rm = TRUE)
  )
```

Kruskal–Wallis test provides evidence of difference among satisfactory trait coverage in the population at the end of 50,000 generations.
```{r con-sat-end-kru}
kruskal.test(pop_uni_obj ~ acron,data = end)
```

Results for post-hoc Wilcoxon rank-sum test with a Bonferroni correction on satisfactory trait coverage in the population at the end of 50,000 generations.

```{r con-sat-end-wil}
pairwise.wilcox.test(x = end$pop_uni_obj, g = end$acron, p.adjust.method = "bonferroni",
                     paired = FALSE, conf.int = FALSE, alternative = 'l')
```


## Activation gene coverage

Activation gene coverage analysis.

### Over time coverage

Activation gene coverage over time.

```{r con-act-ot, warning=FALSE}
contradictory_objectives = filter(cc_over_time, diagnostic == 'contradictory_objectives')
contradictory_objectives$uni_str_pos = contradictory_objectives$uni_str_pos + contradictory_objectives$arc_acti_gene - contradictory_objectives$overlap
lines = contradictory_objectives %>%
        group_by(`Selection\nScheme`, gen) %>%
          dplyr::summarise(
            min = min(uni_str_pos),
            mean = mean(uni_str_pos),
            max = max(uni_str_pos)
          )
points = filter(lines, gen %% 2000 == 0 & gen != 0)

ot = ggplot(lines, aes(x=gen, y=mean, group = `Selection\nScheme`, fill =`Selection\nScheme`, color = `Selection\nScheme`, shape = `Selection\nScheme`)) +
  geom_ribbon(aes(ymin = min, ymax = max), alpha = 0.1) +
  geom_line(size = 0.5) +
  geom_point(data = points, size = 1.5, stroke = 2.0, alpha = 1.0) +
  scale_y_continuous(
    name="Coverage",
    limits=c(-1, 101),
    breaks=seq(0,100, 20),
    labels=c("0", "20", "40", "60", "80", "100")
  ) +
  scale_x_continuous(
    name="Generations",
    limits=c(0, 50000),
    breaks=c(0, 10000, 20000, 30000, 40000, 50000),
    labels=c("0e+6", "1e+6", "2e+6", "3e+6", "4e+6", "5e+6")

  ) +
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  ggtitle("Activation gene coverage over time") +
  p_theme+
    guides(
    shape=guide_legend(ncol=2, title.position = "bottom"),
    color=guide_legend(ncol=2, title.position = "bottom"),
    fill=guide_legend(ncol=2, title.position = "bottom")
  ) +
  theme(
    legend.position = "bottom",
    legend.box="verticle",
    legend.justification="center",
    legend.title=element_blank()
  )

ot
```

### End of 50,000 generations

Activation gene coverage in the population at the end of 50,000 generations.

```{r con-act-end}
end = filter(cc_end, diagnostic == 'contradictory_objectives')
end$uni_str_pos = end$uni_str_pos + end$arc_acti_gene - end$overlap
best = ggplot(end, aes(x = acron, y = uni_str_pos, color = acron, fill = acron, shape = acron)) +
  geom_flat_violin(position = position_nudge(x = .2, y = 0), scale = 'width', alpha = 0.2) +
  geom_point(position = position_jitter(width = .1), size = 1.5, alpha = 1.0) +
  geom_boxplot(color = 'black', width = .2, outlier.shape = NA, alpha = 0.0) +
  scale_y_continuous(
    name="Coverage",
    limits=c(-1, 101),
    breaks=seq(0,100, 20),
    labels=c("0", "20", "40", "60", "80", "100")
  ) +
  scale_x_discrete(
    name="Scheme"
  )+
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  p_theme

plot_grid(
  best +
    ggtitle("Final activation gene coverage") +
    theme(legend.position="none"),
  legend,
  nrow=2,
  rel_heights = c(2,.55),
  label_size = TSIZE
)
```

#### Stats

Summary statistics for activation gene coverage in the population at the end of 50,000 generations.

```{r con-act-end-sum}
end$acron = factor(end$acron, levels = c('nov', 'nds', 'lex', 'pfs', 'gfs', 'ran', 'tor', 'tru'))
group_by(end, acron) %>%
  dplyr::summarise(
    count = n(),
    na_cnt = sum(is.na(uni_str_pos)),
    min = min(uni_str_pos, na.rm = TRUE),
    median = median(uni_str_pos, na.rm = TRUE),
    mean = mean(uni_str_pos, na.rm = TRUE),
    max = max(uni_str_pos, na.rm = TRUE),
    IQR = IQR(uni_str_pos, na.rm = TRUE)
  )
```

Kruskal–Wallis test provides evidence of difference among activation gene coverage in the population at the end of 50,000 generations.
```{r con-act-end-kru}
kruskal.test(uni_str_pos ~ acron,data = end)
```

Results for post-hoc Wilcoxon rank-sum test with a Bonferroni correction on activation gene coverage in the population at the end of 50,000 generations.

```{r con-act-end-sum}
pairwise.wilcox.test(x = end$uni_str_pos, g = end$acron, p.adjust.method = "bonferroni",
                     paired = FALSE, conf.int = FALSE, alternative = 'l')
```


## Nondominated sorting split

Here analyze the satisfactory trait coverage and activation gene coverage results for nondominated sorting, nondominated front ranking (no fitness sharing between fronts), and phenotypic fitness sharing.

### Coverage over time

Satisfactory trait coverage over time.

```{r con-nds-sat-ot, warning=TRUE}
nds <- filter(cc_over_time, acron == 'nds' & diagnostic == 'contradictory_objectives')
nds$'Selection\nScheme' = 'Nondominated sorting (nds)'

nfr <- read.csv('./DATA-FINAL/NONDOMINATEDSORTING/over-time-contradictory_objectives-nondominatedsorting.csv', header = TRUE, stringsAsFactors = FALSE)
nfr$acron = 'nfr'
nfr$'Selection\nScheme' = 'Nondominated front ranking (nfr)'
nfr$diagnostic = 'contradictory_objectives'
nfr <- filter(nfr, trt == 0.0)

pfs <- filter(cc_over_time, acron == 'pfs' & diagnostic == 'contradictory_objectives')
pfs$'Selection\nScheme' = 'Phenotypic fitness sharing (pfs)'

contradictory_objectives <- rbind(nds,nfr,pfs)
contradictory_objectives$`Selection\nScheme` <- factor(contradictory_objectives$`Selection\nScheme`, levels = c('Nondominated sorting (nds)','Nondominated front ranking (nfr)','Phenotypic fitness sharing (pfs)'))

lines = contradictory_objectives %>%
        group_by(`Selection\nScheme`, gen) %>%
          dplyr::summarise(
            min = min(pop_uni_obj),
            mean = mean(pop_uni_obj),
            max = max(pop_uni_obj)
          )
points = filter(lines, gen %% 2000 == 0 & gen != 0)

ot = ggplot(lines, aes(x=gen, y=mean, group = `Selection\nScheme`, fill =`Selection\nScheme`, color = `Selection\nScheme`, shape = `Selection\nScheme`)) +
  geom_ribbon(aes(ymin = min, ymax = max), alpha = 0.1) +
  geom_line(size = 0.5) +
  geom_point(data = points, size = 1.5, stroke = 2.0, alpha = 1.0) +
  scale_y_continuous(
    name="Coverage",
    limits=c(-1, 101),
    breaks=seq(0,100, 20),
    labels=c("0", "20", "40", "60", "80", "100")
  ) +
  scale_x_continuous(
    name="Generations",
    limits=c(0, 50000),
    breaks=c(0, 10000, 20000, 30000, 40000, 50000),
    labels=c("0e+6", "1e+6", "2e+6", "3e+6", "4e+6", "5e+6")

  ) +
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  ggtitle("Satisfactory trait coverage over time") +
  p_theme+
    guides(
    shape=guide_legend(ncol=1, title.position = "bottom"),
    color=guide_legend(ncol=1, title.position = "bottom"),
    fill=guide_legend(ncol=1, title.position = "bottom")
  ) +
  theme(
    legend.position = "bottom",
    legend.box="verticle",
    legend.justification="center",
    legend.title=element_blank()
  )

ot
```

```{r con-nds-sat-lgd, echo = FALSE}
legend <- cowplot::get_legend(
  ot +
    guides(
      shape=guide_legend(ncol=1, title.position = "bottom"),
      color=guide_legend(ncol=1, title.position = "bottom"),
      fill=guide_legend(ncol=1, title.position = "bottom")
    ) +
    theme(
      legend.position = "top",
      legend.box="verticle",
      legend.justification="center",
      legend.title=element_blank()
    )
)
```

### Best coverage throughout

Best satisfactory trait coverage throughout 50,000 generations.

```{r con-nds-sat-bst}
nds <- filter(cc_best, diagnostic == 'contradictory_objectives' & acron == 'nds' & col == 'pop_uni_obj')
nds$'Selection\nScheme' = 'Nondominated sorting (nds)'
nds = subset(nds, select = -c(Selection.Scheme) )

nfr <- read.csv('./DATA-FINAL/NONDOMINATEDSORTING/best-contradictory_objectives-nondominatedsorting.csv', header = TRUE, stringsAsFactors = FALSE)
nfr$acron = 'nfr'
nfr$'Selection\nScheme' = 'Nondominated front ranking (nfr)'
nfr$diagnostic = 'contradictory_objectives'
nfr <- filter(nfr, trt == 0.0 & col == 'pop_uni_obj')

pfs <- filter(cc_best, diagnostic == 'contradictory_objectives' & acron == 'pfs' & col == 'pop_uni_obj')
pfs$'Selection\nScheme' = 'Phenotypic fitness sharing (pfs)'
pfs = subset(pfs, select = -c(Selection.Scheme) )


best <- rbind(nds, nfr, pfs)
best$`Selection\nScheme` <- factor(best$`Selection\nScheme`, levels = c('Nondominated sorting (nds)','Nondominated front ranking (nfr)','Phenotypic fitness sharing (pfs)'))
best$acron <- factor(best$acron, levels = c('nds','nfr','pfs'))

plot = ggplot(best, aes(x = acron, y = val, color = acron, fill = acron, shape = acron)) +
  geom_flat_violin(position = position_nudge(x = .2, y = 0), scale = 'width', alpha = 0.2) +
  geom_point(position = position_jitter(width = .1), size = 1.5, alpha = 1.0) +
  geom_boxplot(color = 'black', width = .2, outlier.shape = NA, alpha = 0.0) +
  scale_y_continuous(
    name="Coverage",
    limits=c(-1, 101),
    breaks=seq(0,100, 20),
    labels=c("0", "20", "40", "60", "80", "100")
  ) +
  scale_x_discrete(
    name="Scheme"
  )+
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  coord_flip()+
  p_theme

plot_grid(
  plot +
    ggtitle("Best satisfactory trait coverage") +
    theme(legend.position="none"),
  legend,
  nrow=2,
  rel_heights = c(2,.6),
  label_size = TSIZE
)
```

#### Stats

Summary statistics for the best satisfactory trait coverage throughout 50,000 generations.

```{r con-nds-sat-bst-sum}
group_by(best, acron) %>%
  dplyr::summarise(
    count = n(),
    na_cnt = sum(is.na(val)),
    min = min(val, na.rm = TRUE),
    median = median(val, na.rm = TRUE),
    mean = mean(val, na.rm = TRUE),
    max = max(val, na.rm = TRUE),
    IQR = IQR(val, na.rm = TRUE)
  )
```

Kruskal–Wallis test provides evidence of difference among best satisfactory trait coverage throughout 50,000 generations

```{r con-nds-sat-bst-kru}
kruskal.test(val ~ acron,data = best)
```

Results for post-hoc Wilcoxon rank-sum test with a Bonferroni correction on best satisfactory trait coverage throughout 50,000 generations.

```{r  con-nds-sat-bst-wil}
pairwise.wilcox.test(x = best$val, g = best$acron, p.adjust.method = "bonferroni",
                     paired = FALSE, conf.int = FALSE, alternative = 'l')
```

### End of 50,000 generations

Satisfactory trait coverage in the population at the end of 50,000 generations.

```{r con-nds-sat-end}
nds <- filter(cc_end, diagnostic == 'contradictory_objectives' & acron == 'nds')
nds$'Selection\nScheme' = 'Nondominated sorting (nds)'

nfr <- read.csv('./DATA-FINAL/NONDOMINATEDSORTING/over-time-contradictory_objectives-nondominatedsorting.csv', header = TRUE, stringsAsFactors = FALSE)
nfr$acron = 'nfr'
nfr$Selection.Scheme = 'Nondominated front ranking (nfr)'
nfr$'Selection\nScheme' = 'Nondominated front ranking (nfr)'
nfr$diagnostic = 'contradictory_objectives'
nfr <- filter(nfr, trt == 0.0 & gen == 50000)
nfr = subset(nfr, select = -c(Selection.Scheme) )

pfs <- filter(cc_end, diagnostic == 'contradictory_objectives' & acron == 'pfs')
pfs$'Selection\nScheme' = 'Phenotypic fitness sharing (pfs)'

end <- rbind(nds, nfr, pfs)
end$acron <- factor(end$acron, levels = c('nds','nfr','pfs'))

best = ggplot(end, aes(x = acron, y = pop_uni_obj, color = acron, fill = acron, shape = acron)) +
  geom_flat_violin(position = position_nudge(x = .2, y = 0), scale = 'width', alpha = 0.2) +
  geom_point(position = position_jitter(width = .1), size = 1.5, alpha = 1.0) +
  geom_boxplot(color = 'black', width = .2, outlier.shape = NA, alpha = 0.0) +
  scale_y_continuous(
    name="Coverage",
    limits=c(-1, 101),
    breaks=seq(0,100, 20),
    labels=c("0", "20", "40", "60", "80", "100")
  ) +
  scale_x_discrete(
    name="Scheme"
  )+
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  coord_flip()+
  p_theme

plot_grid(
  best +
    ggtitle("Final satisfactory trait coverage") +
    theme(legend.position="none"),
  legend,
  nrow=2,
  rel_heights = c(2,.55),
  label_size = TSIZE
)
```

#### Stats

Summary statistics for satisfactory trait coverage in the population at the end of 50,000 generations.

```{r con-nds-sat-end-sum}
group_by(end, acron) %>%
  dplyr::summarise(
    count = n(),
    na_cnt = sum(is.na(pop_uni_obj)),
    min = min(pop_uni_obj, na.rm = TRUE),
    median = median(pop_uni_obj, na.rm = TRUE),
    mean = mean(pop_uni_obj, na.rm = TRUE),
    max = max(pop_uni_obj, na.rm = TRUE),
    IQR = IQR(pop_uni_obj, na.rm = TRUE)
  )
```

Kruskal–Wallis test provides evidence of difference among satisfactory trait coverage in the population at the end of 50,000 generations.

```{r con-nds-sat-end-kru}
kruskal.test(pop_uni_obj ~ acron,data = end)
```

Results for post-hoc Wilcoxon rank-sum test with a Bonferroni correction on satisfactory trait coverage in the population at the end of 50,000 generations.

```{r con-nds-sat-end-wil}
pairwise.wilcox.test(x = end$pop_uni_obj, g = end$acron, p.adjust.method = "bonferroni",
                     paired = FALSE, conf.int = FALSE, alternative = 'l')
```